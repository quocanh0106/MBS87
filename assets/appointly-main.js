window.appointlyConfig||(window.appointlyConfig={apiUrl:"https://booking-api.apntly.com/appointly",clientUniqueId:"65UD2YHLM3XUK5VGTGR9AJ46",booking:{
bookingHtml:'<html>\n<head>\n  <meta charset=\'utf-8\'>\n  <meta name=\'viewport\' content=\'width=device-width, initial-scale=1, shrink-to-fit=no\'>\n  <meta http-equiv=\'x-ua-compatible\' content=\'ie=edge\'>\n    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>\n        <script src="https://cdn.jsdelivr.net/npm/vue-select@3.0.0"></script>\n        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vue-select@3.0.0/dist/vue-select.css">\n      <script src="https://cdn.jsdelivr.net/npm/vue-tel-input@5.14.0"></script>\n        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vue-tel-input@5.14.0/dist/vue-tel-input.css"/>\n      <script src=\'https://cdn.jsdelivr.net/npm/v-calendar@2.3.2/lib/v-calendar.umd.min.js\'></script>\n        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vue-cool-select/dist/themes/bootstrap.css">\n  <style>\n    * {\n      --primary: #6A42C8;\n      --secondary: #87a2fb;\n      --grey:#e4e7ea;\n      --text-black: #353f4d;\n      --text-light-black: #868383;\n    }\n\n    body {\n      color: #353f4d;\n    }\n\n\n    .fade-in {\n      background: rgba(0, 0, 0, 0.65)\n    }\n\n    .modal {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      height: 100vh;\n    }\n\n    .modal-container {\n      -webkit-text-size-adjust: 100%;\n      -webkit-tap-highlight-color: transparent;\n      font-size: 14px;\n      line-height: 1.42857143;\n      -webkit-font-smoothing: antialiased;\n      color: #333333;\n      box-sizing: border-box;\n      border-radius: 5px;\n      padding: 30px 20px 20px 20px;\n      margin: auto;\n      font-family: Helvetica, sans-serif;\n      background: #ffffff;\n      border-color: rgb(230, 230, 230);\n      border-width: 1px;\n      border-style: solid;\n      width: min(95vw, 910px);\n    }\n\n\n    @media only screen and (max-width: 480px) {\n      .modal-container {\n        width: min(350px, 90vw);\n      }\n    }\n\n\n    .container {\n      display: flex;\n      justify-content: center;\n      flex-wrap: wrap;\n      flex-direction: row;\n    }\n\n    .vc-container {\n      width: 100% !important;\n    }\n\n    .time-slots-container {\n      margin-top: 20px;\n      display: flex;\n      flex-wrap: wrap;\n      justify-content: space-between;\n    }\n\n    .cart-container {\n      margin-top: 20px;\n    }\n\n    .time-slot-cart-container {\n      margin-top: 4px;\n      display: flex;\n      flex-wrap: wrap;\n      justify-content: center;\n      max-height: 120px;\n      overflow-x: auto;\n    }\n\n    .time-slots-container {\n      max-height: 200px;\n      overflow-x: auto;\n    }\n\n    .date-time-picker {\n      display: flex;\n      justify-content: center;\n      flex-direction: column;\n    }\n\n    .date-time-picker {\n      width: 100% !important;\n      max-width: min(350px, 80vw) !important;\n    }\n\n\n    .side-menu {\n      margin-left: 0;\n    }\n\n    .select-time-slot {\n      display: block;\n      margin-block-start: 0em;\n      margin-block-end: 1em;\n      margin-inline-start: 0px;\n      margin-inline-end: 0px;\n    }\n\n    .select-time-slot .price {\n      font-weight: 900;\n    }\n\n    .time-slot.disabled, .time-slot.disabled:hover {\n      background: rgba(65, 76, 137, 0.3);\n      cursor: alias;\n    }\n\n    .time-slot:hover {\n      background: rgba(65, 76, 137, 1);\n    }\n\n    .time-slot.selected {\n      background: rgba(65, 76, 137, 1);\n      /*##1fd3c0;*/\n    }\n\n    .time-slot, .time-slot font font, .time-slot-cart-item {\n      color: var(--text-black);\n    }\n\n    .time-slot {\n      background: #0066b2;\n      position: relative;\n      display: block;\n      width: 100%;\n      border: 2px solid transparent;\n      font-size: 12px;\n      font-weight: 300;\n      cursor: pointer;\n      padding: 7px 10px;\n      border-radius: 3px;\n      text-align: center;\n      margin: 0;\n      text-transform: none;\n      margin-bottom: 6px;\n    }\n\n    .time-slot {\n      margin-right: 12px;\n    }\n\n\n    .time-slot-cart-item {\n      width: 80%;\n      background: #0066b2;\n      position: relative;\n      border: 2px solid transparent;\n      font-size: 12px;\n      font-weight: 300;\n      cursor: pointer;\n      padding: 7px 10px;\n      border-radius: 3px;\n      margin: 0;\n      text-transform: none;\n      margin-bottom: 4px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    .tsci-detail {\n      padding-right: 10px;\n    }\n\n    .time-slot-cart-item .delete-icon {\n      margin-left: auto;\n    }\n\n    .time-slot-cart-item .delete-icon img {\n      height: 20px;\n      opacity: 0.8;\n    }\n\n    .time-slot-cart-item .delete-icon img:hover {\n      opacity: 1;\n    }\n\n    .time-slot-meta {\n      color: var(--text-light-black);\n      width: 100%;\n      text-align: center;\n      margin-bottom: 9px;\n      font-size: 12.5px;\n      margin-top: -2px;\n    }\n\n    legend {\n      font-weight: bold;\n    }\n\n\n    .side-menu {\n      /*margin-top: 30px;*/\n      width: 100%;\n    }\n\n    @media (min-width: 768px) {\n      .date-time-picker {\n        max-width: 520px !important;\n      }\n\n      .time-slot {\n        /*width: 40%;*/\n        margin-right: 12px;\n        margin-left: 12px;\n      }\n\n      .time-slots-container {\n        max-height: 320px;\n      }\n\n\n      .book-button-container .btn-book {\n        width: 75%;\n      }\n    }\n\n    @media (min-width: 1000px) {\n      .side-menu {\n        margin-left: 44px;\n        width: 300px;\n      }\n\n      .side-menu {\n        margin-top: 0px;\n      }\n\n      .time-slot {\n        width: 100%;\n      }\n    }\n\n    legend {\n      font-weight: bold !important;\n    }\n\n\n    .btn {\n      border: none;\n      white-space: nowrap;\n      cursor: pointer;\n      -webkit-appearance: none;\n      text-align: center;\n      -webkit-box-sizing: border-box;\n      box-sizing: border-box;\n      outline: 0;\n      -webkit-transition: .1s;\n      transition: .1s;\n      font-weight: 500;\n      -ms-user-select: none;\n      padding: 12px 20px;\n      font-size: 14px;\n      border-radius: 4px;\n      color: #fff;\n      line-height: initial;\n      background: rgba(65, 76, 137, 1);\n    }\n\n    .btn-book {\n      width: 100%;\n    }\n\n    .btn-book .price {\n      float: right;\n      font-weight: 900;\n    }\n\n    .btn-book-margin {\n      margin-top: 40px;\n    }\n\n    .btn-book-questions {\n      min-width: 150px;\n      max-width: 200px;\n      float: right;\n      background-color: var(--primary);\n      color: white;\n    }\n\n    .btn-book-customer-details-questions {\n      min-width: 150px;\n      max-width: 200px;\n      float: right;\n      background-color: var(--primary);\n      color: white;\n    }\n\n    .custom-questions-button-container {\n      margin-top: 40px;\n    }\n\n    .customer-details-questions-button-container {\n      margin-top: 40px;\n    }\n\n    .deposit-payment-button-container {\n      margin-top: 40px;\n    }\n\n    .btn-back-button {\n      color: #8b95a5;\n      letter-spacing: 1px;\n      border-radius: 2px;\n      background-color: #fff;\n      border-color: #ebebeb;\n    }\n\n    .btn-book-questions[disabled] {\n      background: rgba(65, 76, 137, 0.3);\n      cursor: alias;\n    }\n\n    .btn-book-customer-details-questions[disabled] {\n      background: rgba(65, 76, 137, 0.3);\n      cursor: alias;\n    }\n\n    .book-button-container .btn-book[disabled] {\n      background: rgba(65, 76, 137, 0.3);\n      cursor: alias;\n    }\n\n\n    .close-icon {\n      -webkit-text-size-adjust: 100%;\n      -webkit-tap-highlight-color: transparent;\n      -webkit-font-smoothing: antialiased;\n      box-sizing: border-box;\n      font: inherit;\n      margin: 0;\n      overflow: visible;\n      text-transform: none;\n      font-family: inherit;\n      float: right;\n      font-size: 15px;\n      font-weight: bold;\n      line-height: 1;\n      text-shadow: 0 1px 0 #ffffff;\n      opacity: 0.9;\n      color: #cccccc;\n      padding: 0;\n      cursor: pointer;\n      background: transparent;\n      border: 0;\n      appearance: none;\n      margin-right: -5px;\n      margin-top: -20px;\n    }\n\n    .close-icon:hover {\n      color: #0b0d0f;\n      cursor: pointer;\n    }\n\n    .question-text {\n      font-size: 16px;\n      margin-bottom: 8px;\n      display: block;\n      margin-top: 20px;\n      overflow-wrap: break-word;\n    }\n    .question-elements{\n      display: flex;\n    }\n    .ques-cb {\n      margin-right: 15px;\n      align-self: start;\n      margin-top: 5px;\n    }\n\n    .answer-text {\n      width: calc(100% - 24px);\n      border-color: #ebebeb;\n      border-width: 1px;\n      border-radius: 2px;\n      padding: 5px 12px;\n      font-size: 14px;\n      outline: 0;\n      border-style: solid;\n    }\n\n    .vue-tel-input.answer-text {\n      padding: 1px 1px;\n      width: 100%;\n    }\n\n    .answer-text:focus {\n      border-color: var(--secondary);\n      outline: 0;\n    }\n\n    .apntly-branding-powered-by {\n      font-size: 18px;\n      margin-bottom: -10px;\n      float: right;\n      display: flex;\n      align-items: center;\n      margin-top: 30px;\n      justify-content: center;\n      margin-right: -10px;\n    }\n\n    .apntly-branding-powered-by span a {\n      margin-left: 6px;\n      width: 100px;\n      text-decoration: none;\n    }\n\n    .free-booking-success-message-container {\n      color: #4F8A10;\n      background-color: #DFF2BF;\n      margin: 10px 0;\n      padding: 6px 12px;\n    }\n\n    .free-booking-success-message-container .success-message-text {\n      margin: 0;\n      font-size: 20px;\n    }\n\n    hr {\n      border-color: rgba(77, 82, 89, 0.07);;\n    }\n\n    .custom-questions-container {\n      padding-right: 20px;\n    }\n\n    .custom-questions-screen-container {\n      position: relative;\n    }\n\n    .deposit-payment-screen-container {\n      margin-top: 36px;\n    }\n\n    @media (min-width: 800px) {\n      .custom-questions-container {\n        /*max-height: 70vh;*/\n        /*overflow-y: auto;*/\n      }\n\n    }\n\n    .custom-question-selection {\n      /*position: absolute;*/\n      /*width: calc(100% - 24px);*/\n    }\n\n    .custom-question-cart-item-heading {\n      margin-top: 20px;\n      font-size: 16px;\n      font-weight: bold;\n    }\n\n    .vc-highlight {\n      background-color: #3182ce !important;\n    }\n\n    .question-text a {\n      font-size: inherit;\n      color: inherit;\n      font-style: italic;\n    }\n\n    .deposit-payment-option {\n      display: flex;\n      align-items: center;\n      margin-bottom: 15px;\n      overflow-wrap: break-word;\n      cursor: pointer;\n    }\n\n    .deposit-payment-option .radio-input {\n      margin-right: 15px;\n      cursor: pointer;\n    }\n\n    .deposit-payment-option .payment-option-text {\n      margin-top: 0;\n      margin-bottom: 0;\n      font-size: 17px;\n      display: block;\n      overflow-wrap: break-word;\n    }\n\n    .subscription-message {\n      font-weight: 600;\n    }\n\n    .w-100 {\n      width: 100%;\n    }\n\n\n    .mobile-calendar-selector {\n      margin-top: 10px;\n      margin-bottom: 24px;\n    }\n\n\n    /*@media screen and (max-width: 480px) {*/\n    .sm-block {\n      display: block;\n    }\n\n    .sm-hide {\n      display: none;\n    }\n\n    /*}*/\n\n    @media screen and (min-width: 768px) {\n      .md-block {\n        display: block;\n      }\n\n      .md-hide {\n        display: none;\n      }\n    }\n\n    @media screen and (min-width: 1000px) {\n\n      .lg-hide {\n        display: none;\n      }\n\n      .lg-block {\n        display: block;\n      }\n    }\n\n    .date-time-picker {\n      align-self: flex-start;\n    }\n\n    .timezone-container {\n      margin-bottom: 20px;\n    }\n\n    .book-button-container {\n      display: flex;\n      justify-content: center;\n    }\n\n    .loader {\n      border: 4px solid #f3f3f3;\n      border-top: 4px solid;\n      border-top-color: var(--primary);\n      border-radius: 50%;\n      width: 30px;\n      height: 30px;\n      animation: spin 1.5s linear infinite;\n      /*justify-self: center;*/\n      margin: auto;\n    }\n\n    @keyframes spin {\n      0% {\n        transform: rotate(0deg);\n      }\n      100% {\n        transform: rotate(360deg);\n      }\n    }\n\n    .btn-book {\n      background-color: var(--primary);\n    }\n\n    .time-slot {\n      background: transparent;\n      border: 1.9px solid #cbd5e0 !important;\n      color: var(--text-black);\n    }\n\n    .time-slot.selected, .time-slot:hover {\n      background-color: var(--primary);\n      color: white;\n    }\n\n    .time-slot-cart-item {\n      background-color: var(--primary);\n      color: white;\n    }\n\n    /* width */\n    ::-webkit-scrollbar {\n      width: 5px;\n    }\n\n    .apntly-modal-container::-webkit-scrollbar {\n      width: 8px;\n    }\n\n    /* Track */\n    ::-webkit-scrollbar-track {\n      background: #f1f1f1;\n    }\n\n    ::-webkit-scrollbar-thumb {\n      background: var(--primary);\n      opacity: 1;\n    }\n\n    .vs__dropdown-option--highlight {\n      background-color: var(--primary) !important;\n    }\n\n    .vc-highlight, .vc-day-content:hover {\n      background-color: var(--primary) !important;\n      color: white;\n    }\n\n    .vs__dropdown-option {\n      white-space: normal;\n    }\n\n    .admin-booking-options legend {\n      font-weight: 500 !important;\n    }\n\n    .time-slot-container {\n      display: flex;\n      width: 100%;\n    }\n\n    .qty-box {\n      display: flex;\n      margin-bottom: 6px;\n      /*margin-left: 12px;*/\n      margin-right: 12px;\n    }\n\n    .qty-box .qty-btn, .qty-box .qty-val {\n      background: transparent;\n      color: var(--text-black);\n      display: flex;\n      justify-content: center;\n      cursor: pointer;\n      align-items: center;\n    }\n\n    .qty-box .qty-btn {\n      width: 30px;\n      border: 1.9px solid #cbd5e0 !important;\n    }\n\n    .qty-box .qty-btn.sub {\n      border-top-left-radius: 3px;\n      border-bottom-left-radius: 3px;\n    }\n\n    .qty-box .qty-btn.add {\n      border-top-right-radius: 3px;\n      border-bottom-right-radius: 3px;\n    }\n\n    .qty-box .qty-btn.add.disabled {\n      cursor: alias;\n      color: rgba(65, 76, 137, 0.3);\n    }\n\n    .qty-box .qty-val {\n      width: 37px;\n      border-top: 1.9px solid #cbd5e0 !important;\n      border-bottom: 1.9px solid #cbd5e0 !important;\n      border-left-width: 0;\n      border-right-width: 0;\n    }\n\n    .file-item-container {\n      display: flex;\n      margin-top: 15px;\n      flex-wrap: wrap;\n    }\n\n    .file-item {\n      padding: 5px 11px;\n      background-color: var(--grey);\n      border-radius: 20px;\n      color: var(--text-black);\n      margin-right: 10px;\n      margin-bottom: 10px;\n      display: flex;\n    }\n\n    .file-item .file-name {\n      margin-right: 8px;\n      word-break: break-word;\n      white-space: normal;\n    }\n\n    .file-item .delete-icon {\n      font-size: 13px;\n      font-weight: 700;\n      margin-left: auto;\n      opacity: 0.8;\n      cursor: pointer;\n      align-self: center;\n    }\n\n    .file-item .delete-icon:hover {\n      opacity: 1;\n    }\n\n    .file-upload-btn-container {\n      display: flex;\n    }\n\n    .file-upload-btn-container .file-upload-btn {\n      padding: 8px 20px;\n      background: var(--grey);\n      opacity: 1;\n      border: none;\n      border-radius: 3px;\n      color: var(--black);\n      font-weight: 500;\n    }\n\n    .file-upload-btn-container .loader {\n      margin-left: 20px;\n      width: 22px;\n      height: 22px;\n      border-width: 3px;\n    }\n    .vs__selected{\n      background-color: var(--grey);\n      border: none;\n      border-radius: 2px;\n      padding: 2px 6px;\n    }\n    @media screen and (min-width: 768px) {\n      .btn-book-customer-details-questions {\n        max-width: 300px;\n      }\n      .btn-book-questions {\n        max-width: 300px;\n      }\n    }\n  </style>\n\n  <style>\n    @import url(\'https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap\');\n*{\n  font-family: \'Montserrat\', sans-serif;\n}\n.time-slot{\n  font-weight: 400;\n}\n\n    \n    \n  </style>\n</head>\n<body class="fade-in pop-up-container apntly-modal-container is-embed-val">\n\n<div class="modal" id=\'app\'>\n  <div class="modal-container" :key="renderKey">\n    <button type="button" class="close-icon action-close"\n            data-dismiss="modal"\n            @click="closeModal">X\n    </button>\n\n    <div class="admin-booking-options" style="border: 2px solid #cbd5e0;padding: 12px;margin-top: 10px"\n         v-if="isAdmin()">\n      <h3 style="margin-top: 0px">Admin Booking Options</h3>\n\n      <div style="display: flex;align-items: start;margin-top: 4px">\n        <input type="checkbox" style="margin-right: 8px" @input="adminSlotChanged()" v-model="showAllSlots"/>\n        <legend>Override Availability <span>(Ignore Availability time, and show every slots as available)</span>\n        </legend>\n      </div>\n\n      <div style="display: flex;align-items: start;margin-top: 4px">\n        <input type="checkbox" style="margin-right: 8px" @input="adminSlotChanged()" v-model="ignoreBookedSlots"/>\n        <legend>Ignore Bookings / Calendar Events <span>(Show Booked Slots as available)</span>\n        </legend>\n      </div>\n\n      <div style="display: flex;align-items: start;margin-top: 4px">\n        <input type="checkbox" style="margin-right: 8px" @input="adminSlotChanged()" v-model="adminCreateDraftOrder"/>\n        <legend class="font-weight-400">Create Draft Order <span>(Create Draft Order for this booking. Note: Visit Shopify Orders-> Draft to send\n          Invoice Email to customer)</span>\n        </legend>\n      </div>\n\n      <div style="display: flex;align-items: start;margin-top: 4px" v-if="serviceMergeTeamMemberEnabled()">\n        <input type="checkbox" style="margin-right: 8px" @input="adminSlotChanged()" v-model="adminMergeTeamMember"/>\n        <legend>Merge team Members slots? <span>(Show slots of all team members)</span>\n        </legend>\n      </div>\n\n      <div style="display: flex;align-items: start;margin-top: 4px" v-if="isRescheduleEvent()">\n        <input type="checkbox" style="margin-right: 8px" v-model="sendEmail"/>\n        <legend>Send Email\n        </legend>\n      </div>\n    </div>\n\n\n    <h3 v-if="screen===1" class="main-heading">\n      {{ selectDateText }}\n    </h3>\n    <h3 v-if="screen===2" class="main-heading">\n      {{ customQuestionsHeadingText }}\n    </h3>\n    <h3 v-if="screen===3" class="main-heading">\n      {{ freeBookingScreenContactDetailsHeadingText }}\n    </h3>\n    <h3 v-if="screen===5" class="main-heading">\n      {{ depositPaymentScreenHeadingText }}\n    </h3>\n\n    <template v-if="screen===1">\n      <h3 v-if="isSubscriptionAppointment()" class="subscription-message">\n       <div v-html="subscriptionAppointmentMessage"></div>\n      </h3>\n    </template>\n\n    <template v-if="screen===1">\n      <div class="container">\n        <div class="mobile-calendar-selector sm-block lg-hide w-100" v-if="true">\n          <div :key="variantKey">\n            <div id="variant-container" v-if="showVariantContainer">\n              <label style="font-weight: 600">{{ selectVariantText }}</label>\n              <v-select\n                @input="onSelectionChange()"\n                class="variant-selection"\n                :options="variants" label="text" :reduce="item => item.value"\n                v-model="selectedVariant"\n                style="margin-top: 5px;\n                 margin-bottom: 20px"></v-select>\n            </div>\n          </div>\n          <div id="team-member-container" v-if="showTeamMemberContainer">\n\n            <label style="font-weight: 600">{{ selectTeamMemberText }}</label>\n            <v-select\n              @input="onSelectionChange()"\n              :key="employeeKey"\n              :options="variantEmployees" label="text" :reduce="item => item.value"\n              v-model="selectedEmployee"\n              style="margin-top: 5px"></v-select>\n\n          </div>\n        </div>\n        <div class="date-time-picker">\n          <div class="date-picker">\n            <v-date-picker :min-date=\'new Date()\'\n                           v-if="setCalenderEvent()"\n                           :max-date="maxDate"\n                           :key="calendarKey"\n                           ref="datep"\n                           :disabled-dates="disabledDates"\n                           @input="onSelectionChange()"\n                           v-model=\'selectedDate\'/>\n          </div>\n\n          <div style="margin-top: 20px" class="timezone-container">\n            <div style="font-size: 12px;display: flex;align-items: center;">\n              <svg\n\n                aria-hidden="true" focusable="false" data-prefix="fas" data-icon="globe-americas"\n                height="12px" style="margin-right: 4px;height: 12.5px;"\n                class="svg-inline--fa fa-globe-americas fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg"\n                viewBox="0 0 496 512">\n                <path fill="currentColor"\n                      d="M248 8C111.03 8 0 119.03 0 256s111.03 248 248 248 248-111.03 248-248S384.97 8 248 8zm82.29 357.6c-3.9 3.88-7.99 7.95-11.31 11.28-2.99 3-5.1 6.7-6.17 10.71-1.51 5.66-2.73 11.38-4.77 16.87l-17.39 46.85c-13.76 3-28 4.69-42.65 4.69v-27.38c1.69-12.62-7.64-36.26-22.63-51.25-6-6-9.37-14.14-9.37-22.63v-32.01c0-11.64-6.27-22.34-16.46-27.97-14.37-7.95-34.81-19.06-48.81-26.11-11.48-5.78-22.1-13.14-31.65-21.75l-.8-.72a114.792 114.792 0 0 1-18.06-20.74c-9.38-13.77-24.66-36.42-34.59-51.14 20.47-45.5 57.36-82.04 103.2-101.89l24.01 12.01C203.48 89.74 216 82.01 216 70.11v-11.3c7.99-1.29 16.12-2.11 24.39-2.42l28.3 28.3c6.25 6.25 6.25 16.38 0 22.63L264 112l-10.34 10.34c-3.12 3.12-3.12 8.19 0 11.31l4.69 4.69c3.12 3.12 3.12 8.19 0 11.31l-8 8a8.008 8.008 0 0 1-5.66 2.34h-8.99c-2.08 0-4.08.81-5.58 2.27l-9.92 9.65a8.008 8.008 0 0 0-1.58 9.31l15.59 31.19c2.66 5.32-1.21 11.58-7.15 11.58h-5.64c-1.93 0-3.79-.7-5.24-1.96l-9.28-8.06a16.017 16.017 0 0 0-15.55-3.1l-31.17 10.39a11.95 11.95 0 0 0-8.17 11.34c0 4.53 2.56 8.66 6.61 10.69l11.08 5.54c9.41 4.71 19.79 7.16 30.31 7.16s22.59 27.29 32 32h66.75c8.49 0 16.62 3.37 22.63 9.37l13.69 13.69a30.503 30.503 0 0 1 8.93 21.57 46.536 46.536 0 0 1-13.72 32.98zM417 274.25c-5.79-1.45-10.84-5-14.15-9.97l-17.98-26.97a23.97 23.97 0 0 1 0-26.62l19.59-29.38c2.32-3.47 5.5-6.29 9.24-8.15l12.98-6.49C440.2 193.59 448 223.87 448 256c0 8.67-.74 17.16-1.82 25.54L417 274.25z"></path>\n              </svg>\n              Timezone: {{ getBrowserTimezone() }}\n            </div>\n\n          </div>\n          <div :class="{\'desktop-calendar-selector\':true,\' sm-hide lg-block \':true }">\n            <div>\n              <div :key="variantKey">\n                <div id="variant-container" v-if="showVariantContainer">\n                  <label style="font-weight: 600">{{ selectVariantText }}</label>\n                  <v-select\n                    @input="onSelectionChange()"\n                    class="variant-selection"\n                    :options="variants" label="text" :reduce="item => item.value"\n                    v-model="selectedVariant"\n                    style="margin-top: 5px;\n                 margin-bottom: 20px"></v-select>\n                </div>\n              </div>\n              <div id="team-member-container" v-if="showTeamMemberContainer">\n\n                <label style="font-weight: 600">{{ selectTeamMemberText }}</label>\n                <v-select\n                  @input="onSelectionChange()"\n                  :key="employeeKey"\n                  :options="variantEmployees" label="text" :reduce="item => item.value"\n                  v-model="selectedEmployee"\n                  style="margin-top: 5px"></v-select>\n\n              </div>\n            </div>\n\n            <div :class="{\'btn-book-margin\':true ,\'sm-hide lg-block\':true}"></div>\n\n            <div class="book-button-container" :key="bookNowButtonKey">\n\n              <button class="btn btn-book"\n                      :disabled="bookNowDisabled"\n                      @click="onBookNowClicked()">{{ bookNowButtonText }}\n              </button>\n            </div>\n          </div>\n        </div>\n        <div class="side-menu">\n          <div class="select-time-slot" v-html="getSelectTimeSlotText()">\n          </div>\n          <div class="loader" v-if="isLoading"></div>\n          <template v-if="timeSlots.length">\n            <div class="time-slots-container" :key="timeSlotKey">\n              <template v-for="timeSlot in timeSlots">\n                <div :class="{\'time-slot-container\':true,\'disabled\':isTimeSlotDisabled(timeSlot)}">\n                  <div\n                    :class="{\'time-slot\':true,\'disabled\':isTimeSlotDisabled(timeSlot),\'selected\':(!showModalCart() && getSelectedSlotCount(timeSlot)>0)}"\n                    @click="timeSlot.available?selectTimeSlot(timeSlot):()=>{}">\n                    {{ timeSlot.start + (!hideEndTime() ? " - " + timeSlot.end : \'\') }}\n                  </div>\n                  <template v-if="showModalCart() && cartItems.length>0">\n                    <div class="qty-box"\n                         v-if="getSelectedSlotCount(timeSlot)>0 && timeSlot.serviceVariant.isGroupAppointment">\n                      <div class="qty-btn sub" @click="removeTimeSlot(timeSlot)">-</div>\n                      <div class="qty-val">\n                        {{ getSelectedSlotCount(timeSlot) }}\n                      </div>\n                      <div :class={"qty-btn":true,\'add\':true,\'disabled\':!timeSlot.available}\n                           @click="timeSlot.available?selectTimeSlot(timeSlot):()=>{}">+\n                      </div>\n                    </div>\n                  </template>\n                </div>\n                <template v-if="showTimeSlotMeta()">\n                  <div :class="{\'time-slot-meta\':true,\'disabled\':!timeSlot.available}" v-if="timeSlot.available">\n                    {{ timeSlot.totalAllowedSlots - timeSlot.noOfSameTimeBooking }}/{{ timeSlot.totalAllowedSlots }}\n                    {{ slotRemainingText }}\n                  </div>\n                  <div :class="{\'time-slot-meta\':true,\'disabled\':!timeSlot.available}" v-else>\n                    0/{{ timeSlot.totalAllowedSlots }} {{ slotRemainingText }}\n                  </div>\n                </template>\n              </template>\n            </div>\n          </template>\n          <div class="cart-container" v-if="showModalCart() && cartItems.length>0">\n            <label style="font-weight: 600">{{ cartText }}</label>\n            <div class="time-slot-cart-container">\n              <template v-for="(cartItem,cartItemIndex) in cartItems">\n                <div class="time-slot-cart-item">\n                  <div class="tsci-detail">\n                    <div class="tsci-sv-detail" v-if="cartItem.timeSlot.serviceVariant.title!==\'Default Title\'">\n                      {{ selectVariantText }}: {{ cartItem.timeSlot.serviceVariant.title }}\n                    </div>\n                    <div class="tsci-tm-detail">\n                      {{ selectTeamMemberText }}: {{ cartItem.timeSlot.employee.name }}\n                    </div>\n                    {{ dateText }}: {{ getDateFromTimestampStartBrowserFormatted(cartItem.timeSlot.bookingTimestamp) }}\n                    {{timeText}}: {{ cartItem.timeSlot.start + (!hideEndTime() ? " - " + cartItem.timeSlot.end : \'\') }}\n                  </div>\n                  <span class="delete-icon" @click="removeCartItem(cartItemIndex)"><img\n                    src="https://img.icons8.com/external-kiranshastry-lineal-kiranshastry/64/000000/external-delete-multimedia-kiranshastry-lineal-kiranshastry.png"/></span>\n                </div>\n              </template>\n            </div>\n          </div>\n\n          <!---if modal cart is to be shown always show -->\n          <!--          <div :class="{\'btn-book-margin\':true }" v-if="useMobileTopCalendarSelectorLayout()"></div>-->\n          <div :class="{\'btn-book-margin sm-block lg-hide\':true }"></div>\n\n          <div class="sm-block lg-hide">\n            <div class="book-button-container" :key="bookNowButtonKey">\n              <button class="btn btn-book"\n                      :disabled="bookNowDisabled"\n                      @click="onBookNowClicked()">{{ bookNowButtonText }}\n              </button>\n            </div>\n          </div>\n          <p v-if="!this.getSelectedSlot()" class="time-slot-not-selected-text">{{ timeSlotNotSelectedText }}</p>\n\n        </div>\n      </div>\n    </template>\n    <template v-if="screen===2">\n      <input type="file" ref="file-upload-input"\n             style="display: none"\n             :key="fileUploadKey"\n             multiple="multiple"\n             @change="uploadFile($event)">\n      <div class="custom-questions-screen-container">\n        <div class="custom-questions-container">\n          <template v-for="(cartItem,cartItemIndex) in cartItems">\n            <div class="custom-question-cart-item-heading" v-if="cartItems.length>1">\n              {{ getBookingHeadingText() }}: {{ cartItem.timeSlot.serviceVariant.title }}\n              Date: {{ getDateFromTimestampStartBrowserFormatted(cartItem.timeSlot.bookingTimestamp) }}\n              Time: {{ cartItem.timeSlot.start + (!hideEndTime() ? " - " + cartItem.timeSlot.end : \'\') }}\n            </div>\n            <template v-for="(question,questionIndex) in cartItem.timeSlot.serviceVariant.questions"\n                      v-if="cartItem.timeSlot.serviceVariant.questions && cartItem.timeSlot.serviceVariant.questions.length>0">\n\n              <div class="question-text">\n                <div class="question-elements">\n                  <div class="ques-cb-ct"  v-if="question.type===7">\n                  <input type="checkbox"\n                         class="ques-cb"\n                         :checked="question.answer===\'yes\'"\n                         @change="(e)=>checkboxInput(question,e)"\n                  >\n                  </div>\n                  <div v-html="getQuestionHtml(question.question)">\n                  </div>\n                </div>\n              </div>\n              <textarea v-if="question.type===1" class="answer-text" id="" rows="3"\n                        @keyup="calculateCustomQuestionsButtonDisabled()"\n                        :value="question.answer" @input=\'e => question.answer = e.target.value\'\n              ></textarea>\n              <input v-if="question.type===6" class="answer-text"\n                        @keyup="calculateCustomQuestionsButtonDisabled()"\n                        :value="question.answer" @input=\'e => question.answer = e.target.value\'\n              >\n\n              <template v-if="question.type===3">\n                <div class="custom-question-selection-container">\n\n                  <v-select\n                    @input="calculateCustomQuestionsButtonDisabled()"\n                    class="custom-question-selection"\n                    :options="question.options.map(x=>{\n                return {\n                  text:x.text,\n                  value:x.text\n                }\n              })" label="text" :reduce="item => item.value"\n                    v-model="question.answer"\n                    style="margin-top: 5px;\n          margin-bottom: 20px"></v-select>\n                </div>\n              </template>\n\n              <template v-if="question.type===4">\n                <div class="custom-question-file-container"\n                     :ref="cartItemIndex+\'-\'+questionIndex+\'-ques-ref\'">\n                  <div class="file-upload-btn-container">\n                    <button class="btn file-upload-btn" @click="()=>uploadFileClicked(question)">{{ chooseFileText }}\n                    </button>\n                    <div class="loader" v-if="isFileUpoading"></div>\n                  </div>\n\n\n                  <div v-if="question.answer">\n                    <div class="file-item-container">\n                      <div v-for="(item,linkIndex) in getAllLinks(question.answer)">\n                        <div class="file-item">\n                          <div class="file-name">{{ item }}</div>\n                          <span class="delete-icon" @click="removeLink(question,linkIndex)">X</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                </div>\n\n              </template>\n\n              <template v-if="question.type===5">\n                <div class="custom-question-selection-container">\n                  <v-select multiple\n                            @input="calculateCustomQuestionsButtonDisabled()"\n                            class="custom-question-selection"\n                            :options="question.options.map(x=>{\n                return {\n                  text:x.text,\n                  value:x.text\n                }\n              })" label="text" :reduce="item => item.value"\n                            v-model="question.answerMultiSelect"\n                            style="margin-top: 5px;\n          margin-bottom: 20px"></v-select>\n                </div>\n              </template>\n            </template>\n            <hr v-if="cartItems.length>1" style="margin-top: 20px"/>\n          </template>\n        </div>\n        <div class="custom-questions-button-container">\n          <button class="btn btn-back-button" @click="setScreen(1)">\n            {{ goBackButtonText }}\n          </button>\n          <button class="btn btn-book-questions"\n                  :disabled="customQuestionsButtonDisabled"\n                  @click="customQuestionsButtonClicked()">\n            {{ bookNowButtonText }}\n          </button>\n        </div>\n      </div>\n\n    </template>\n    <template v-if="screen===3">\n      <div>\n        <p class="question-text">{{ freeBookingScreenFullNameText }}</p>\n        <input class="answer-text"\n               v-model="customerDetailQuestions.name"\n        />\n\n        <p class="question-text">{{ freeBookingScreenEmailText }}</p>\n        <input class="answer-text"\n               v-model="customerDetailQuestions.email"\n        />\n        <template v-if="isPhoneFieldEnabledInFreeBooking()">\n          <p class="question-text">{{ freeBookingScreenPhoneNumberText }}</p>\n          <vue-tel-input v-model="customerDetailQuestions.phoneNo"\n                         :default-country="getDefaultCountry()"\n                         class="answer-text"\n                         @open="onDropdownOpen(true)"\n                         v-on:country-changed="countryChanged"\n                         @close="onDropdownOpen(false)">\n            <template v-slot:arrow-icon>\n              <span v-if="phoneNumberDropDown">▲</span>\n              <span v-else>▼</span>\n            </template>\n          </vue-tel-input>\n        </template>\n\n        <div class="customer-details-questions-button-container">\n          <button class="btn btn-back-button" @click="setScreen(questions.length>0?2:1)">\n            {{ goBackButtonText }}\n          </button>\n          <button class="btn btn-book-customer-details-questions"\n                  :disabled="customerDetailQuestionsButtonDisabled()"\n                  @click="customerDetailsQuestionsButtonClicked()">\n            {{ bookNowButtonText }}\n          </button>\n        </div>\n      </div>\n\n    </template>\n    <template v-if="screen===4">\n      <div class="free-booking-success-message-container">\n        <div class="success-message-text" v-html="getConfirmationMessageHtml(freeBookingScreenConfirmationMessageText)">\n        </div>\n        <!--        <p class="success-message-text">{{ freeBookingScreenConfirmationMessageText }}</p>-->\n      </div>\n\n    </template>\n    <template v-if="screen===5">\n      <div class="deposit-payment-screen-container">\n        <template v-for="(option,paymentOptIdx) in getDepositPaymentOptions()">\n          <div class="deposit-payment-option" @click="selectedDepositPaymentOption=paymentOptIdx">\n            <input type="radio" class="radio-input" :checked="selectedDepositPaymentOption===paymentOptIdx"\n                   />\n            <p class="payment-option-text">{{ option.text }}</p>\n          </div>\n        </template>\n        <div class="deposit-payment-button-container">\n          <button class="btn btn-back-button" @click="setScreen(1)">\n            {{ goBackButtonText }}\n          </button>\n          <button class="btn btn-book-questions"\n                  :disabled="depositPaymentButtonDisabled()"\n                  @click="depositPaymentButtonClicked()">\n            {{ bookNowButtonText }}\n          </button>\n        </div>\n      </div>\n    </template>\n    <p class="apntly-branding-powered-by" v-if="brandingEnabled">Powered By <span>\n      <a href="#" width="50px" @click.prevent="openAppPage">Appointly</a></span></p>\n  </div>\n</div>\n\n\n<script id="vue-script">\n  Vue.component(\'v-select\', VueSelect.VueSelect);\n  // Vue.component(\'v-cool-select\', VueSelect.VueSelect)\n  //  Vue.component(\'v-cool-select\',vueCoolSelect.CoolSelect)\n  window.apntlyBookingModal = new Vue({\n    el: \'#app\',\n    data: {\n      screen: 1,\n      selectDateText: "Select Date",\n      selectTimeSlotText: "Select preferred time slot",\n      timeSlotPriceText: "{{{timeSlotPriceText}}}",\n      selectVariantText: "Service",\n      selectTeamMemberText: "Team Member",\n      cartText: "Cart:",\n      slotRemainingText: "slots remaining",\n      dateText: "Date",\n      timeText: "Time",\n      timeSlotNotSelectedText: "Please select a time slot",\n      bookNowButtonText: "Book Now",\n      customQuestionsHeadingText: "Please answer few questions",\n      goBackButtonText: "Back",\n      freeBookingScreenContactDetailsHeadingText: "Please enter your Contact Details",\n      depositPaymentScreenHeadingText: "Payment Options (Pay Deposit amount now, and remaining after the appointment): ",\n      freeBookingScreenFullNameText: "Full Name",\n      freeBookingScreenEmailText: "Email",\n      freeBookingScreenPhoneNumberText: "Contact No.",\n      freeBookingScreenConfirmationMessageText: "Your Booking is Confirmed. We have sent you confirmation email with appointment details.",\n      chooseFileText: "Choose File",\n      showVariantPrice: \'{{{showVariantPrice}}}\',\n      renderKey: 1,\n      calendarKey: "ck",\n      employeeKey: "ek",\n      variantKey: "vk",\n      timeSlotKey: "tsl",\n      bookNowButtonKey: "bookbk",\n      iFrameId: "{{{iFrameId}}}",\n      str: "2,",\n      selectedDate: new Date(),\n      maxDate: null,\n      disabledDates: [],\n      availableDates: [],\n      variants: [{text: "1/1", value: "1"}, {text: "2/2", value: "2"}],\n      selectedVariant: null,\n      // simple example of items\n      variantEmployees: [],\n      selectedEmployee: null,\n      // there will be a selected item\n      selected: \'Item 1\',\n      timeSlots: [],\n      cartItems: [],\n      questions: [],\n      customerDetailQuestions: {\n        name: \'\',\n        email: \'\',\n        phoneNo: \'\',\n        phoneNumberCountryDetails: {},\n      },\n      isCountryCodeValid: false,\n      phoneNumberDropDown: false,\n      customQuestionsButtonDisabled: true,\n      showVariantContainer: true,\n      showTeamMemberContainer: true,\n      showAllSlots: false,\n      ignoreBookedSlots: false,\n      adminMergeTeamMember: true,\n      adminCreateDraftOrder: false,\n      sendEmail: true,\n      brandingEnabled: true,\n      selectedDepositPaymentOption: -1,\n      subscriptionAppointmentMessage: \'\',\n      bookNowDisabled: true,\n      isLoading: false,\n      fileUploadQuestion: null,\n      fileUploadKey: \'fillupk\',\n      isFileUpoading: false\n    },\n    methods: {\n      selectTimeSlot: function (timeSlot) {\n        console.log(timeSlot)\n        if (!this.showModalCart()) {\n          this.timeSlots.map(x => x.selected = false)\n          timeSlot.selected = true;\n          let slots = this.timeSlots;\n          this.timeSlots = []\n          this.timeSlots = slots;\n          this.cartItems = [];\n          this.cartItems.push({\n            timeSlot: timeSlot\n          });\n          window.parent.appointlyClient.isBookNowButtonDisabled();\n        }\n        if (this.showModalCart()) {\n          // timeSlot.selected = true;\n          this.cartItems.push({\n            timeSlot: timeSlot\n          })\n          let slots = this.timeSlots;\n          this.timeSlots = []\n          this.timeSlots = slots;\n          window.parent.appointlyClient.isBookNowButtonDisabled();\n          this.onSelectionChange()\n        }\n      },\n      removeCartItem: function (cartItemIndex) {\n        this.cartItems.splice(cartItemIndex, 1)\n        if (this.cartItems.length === 0) {\n          window.parent.appointlyClient.isBookNowButtonDisabled()\n        }\n        this.onSelectionChange()\n      },\n      onSelectionChange: function () {\n        parent.window.appointlyClient.onSelectionChange()\n      },\n      adminSlotChanged: function () {\n        parent.window.appointlyClient.adminSlotChanged()\n      },\n\n      onBookNowClicked: function () {\n        parent.window.appointlyClient.onBookNowClicked()\n      },\n\n      customQuestionsButtonClicked: function () {\n        // parent.window.console.log("customQuestionsButtonClicked")\n        parent.window.appointlyClient.customQuestionsButtonClicked()\n      },\n      customerDetailsQuestionsButtonClicked: function () {\n        parent.window.appointlyClient.customerDetailsQuestionsButtonClicked()\n      },\n      depositPaymentButtonClicked: function () {\n        parent.window.appointlyClient.depositPaymentButtonClicked()\n      },\n      closeModal: function () {\n        parent.window.appointlyClient.closeBookModal()\n      },\n\n      getBrowserTimezone() {\n        window["datep"] = this.$refs["datep"]\n        this.setCalenderEvent();\n        return parent.window.appointlyClient.getBrowserTimezone()\n      },\n      setCalenderEvent() {\n        try {\n          if (!this.$refs["datep"] || !this.$refs["datep"].$refs || !this.$refs["datep"].$refs.calendar) {\n            return true;\n          }\n          if (!document.querySelector(".vc-arrow.is-left").getAttribute("isEventSet")) {\n            document.querySelector(".vc-arrow.is-left").addEventListener(\'click\', () => {\n              //if user is switching month dont switch to first available date\n              window.parent.appointlyClient.setIsFirstTimeDateSelected(true);\n              window.parent.appointlyClient.onSelectionChange()\n            });\n            document.querySelector(".vc-arrow.is-left").setAttribute(\'isEventSet\', true)\n          }\n          if (!document.querySelector(".vc-arrow.is-right").getAttribute("isEventSet")) {\n            document.querySelector(".vc-arrow.is-right").addEventListener(\'click\', () => {\n              window.parent.appointlyClient.setIsFirstTimeDateSelected(true);\n              window.parent.appointlyClient.onSelectionChange()\n            });\n            document.querySelector(".vc-arrow.is-right").setAttribute(\'isEventSet\', true)\n          }\n        } catch (e) {\n          console.log("Cant Attach Calender events", e)\n        }\n        return true\n      },\n      getSelectedSlot() {\n        return parent.window.appointlyClient && parent.window.appointlyClient.getSelectedSlot();\n      },\n      calculateCustomQuestionsButtonDisabled() {\n        if (this.isFileUpoading) {\n          this.customQuestionsButtonDisabled = true;\n          return;\n        }\n        let allCartQuestions = window.parent.appointlyClient.getCartItemQuestions();\n        for (let question of allCartQuestions) {\n          if (question.type === 5) {\n            if (question.answerMultiSelect)\n              question.answer = question.answerMultiSelect.join(", ").trim()\n            else\n              question.answer = \'\'\n          }\n          if(question.type===7){\n            question.answer=question.answer || \'no\'\n          }\n        }\n        let requiredQuestions = allCartQuestions.filter(x => x.required !== false)\n        if (requiredQuestions.some(x => !x.answer) || (requiredQuestions.some(x=>x.type===7 && x.answer==="no"))) {\n          this.customQuestionsButtonDisabled = true;\n          return;\n        }\n        this.customQuestionsButtonDisabled = false;\n      },\n      customerDetailQuestionsButtonDisabled() {\n        //true means disabled\n        if (!this.customerDetailQuestions.name) {\n          return true\n        }\n        if (!this.customerDetailQuestions.email || !window.parent.appointlyClient\n          .checkIfEmailValid(this.customerDetailQuestions.email)) {\n          return true\n        }\n        if (this.isPhoneFieldEnabledInFreeBooking()) {\n          if (!this.customerDetailQuestions.phoneNo || !window.parent.appointlyClient\n            .checkIfPhoneNumberValid(this.customerDetailQuestions.phoneNo)) {\n            return true\n          }\n          let countryCode = this.customerDetailQuestions.phoneNumberCountryDetails.dialCode\n          if (!countryCode) {\n            this.isCountryCodeValid = false\n            return true\n          }\n        }\n        return false\n      },\n      depositPaymentButtonDisabled: function () {\n        return this.selectedDepositPaymentOption === -1\n      },\n      setScreen(no) {\n        this.screen = no\n      },\n      isPhoneFieldEnabledInFreeBooking() {\n        return window.parent.appointlyClient.isPhoneFieldEnabledInFreeBooking()\n      },\n      hideEndTime() {\n        return window.parent.appointlyClient.hideEndTime()\n      },\n      showModalCart() {\n        return window.parent.appointlyClient && window.parent.appointlyClient.showModalCart()\n      },\n      showTimeSlotMeta() {\n        return window.parent.appointlyClient && window.parent.appointlyClient.showTimeSlotMeta()\n      },\n      getDateFromTimestampStartBrowserFormatted(timestamp) {\n        return window.parent.appointlyClient.getDateFromTimestampStartBrowserFormatted(timestamp)\n      },\n      getBookingHeadingText() {\n        return window.parent.appointlyClient.getBookingHeadingText();\n      },\n      getDefaultCountry() {\n        return window.parent.appointlyClient.getDefaultCountry();\n      },\n      openAppPage() {\n        window.open("https://apps.shopify.com/appointly", "_blank")\n      },\n\n      getQuestionHtml(questionText) {\n        return questionText\n      },\n      getConfirmationMessageHtml(text) {\n        return text\n      },\n\n      useMobileTopCalendarSelectorLayout() {\n        return window.parent.appointlyClient.useMobileTopCalendarSelectorLayout()\n      },\n\n      getCurrentVariantPrice() {\n        let price = window.parent.appointlyClient.getCurrentVariantPrice();\n        return price;\n      },\n      mergeTeamMemberSlots() {\n        return window.parent.appointlyClient.mergeTeamMemberSlots();\n      },\n      serviceMergeTeamMemberEnabled() {\n        return window.parent.appointlyClient.serviceMergeTeamMemberEnabled();\n      },\n      getDepositPaymentOptions() {\n        return window.parent.appointlyClient.getDepositPaymentOptions();\n      },\n      getSelectTimeSlotText() {\n        let price = this.getCurrentVariantPrice();\n        price = \'<span class="price">\' + price + \'<span>\';\n        let text = this.selectTimeSlotText.replace(\'{{amount}}\',\n          price);\n        return text;\n      },\n      isAdmin() {\n        return window.parent.appointlyClient.isAdmin();\n      },\n      isRescheduleEvent() {\n        return window.parent.appointlyClient.isRescheduleEvent();\n      },\n      isSubscriptionAppointment() {\n        return window.parent.appointlyClient.isSubscriptionAppointment(this.selectedVariant);\n      },\n      countryChanged(country) {\n        this.customerDetailQuestions.phoneNumberCountryDetails = country;\n        this.isCountryCodeValid = true;\n        console.log(country)\n      },\n      onDropdownOpen(value) {\n        this.phoneNumberDropDown = value\n      },\n      getSelectedSlotCount(timeSlot) {\n        let count = this.cartItems.filter(x => (x.timeSlot.serviceVariant.uniqueId === timeSlot.serviceVariant.uniqueId) &&\n          (x.timeSlot.employee.uniqueId === timeSlot.employee.uniqueId)\n          && (Number(x.timeSlot.bookingTimestamp) === Number(timeSlot.bookingTimestamp))).length\n        return count\n      },\n      removeTimeSlot(timeSlot) {\n        let index = this.cartItems.findIndex(x => (x.timeSlot.serviceVariant.uniqueId === timeSlot.serviceVariant.uniqueId) &&\n          (x.timeSlot.employee.uniqueId === timeSlot.employee.uniqueId)\n          && (Number(x.timeSlot.bookingTimestamp) === Number(timeSlot.bookingTimestamp)))\n        if (index !== -1) {\n          this.removeCartItem(index)\n        }\n      },\n      isTimeSlotDisabled(timeSlot) {\n        return ((!this.showModalCart() && !timeSlot.available) || (\n          this.showModalCart() && !timeSlot.available\n        ))\n      },\n      uploadFileClicked(question) {\n        if (this.isFileUpoading) {\n          return\n        }\n        this.fileUploadQuestion = question\n        this.$refs["file-upload-input"].click()\n      },\n      uploadFile(e) {\n        window.parent.appointlyClient.uploadFile(e);\n      },\n      getAllLinks(answer) {\n        return window.parent.appointlyClient.getAllLinks(answer);\n      },\n      removeLink(question, linkIndex) {\n        return window.parent.appointlyClient.removeLink(question, linkIndex);\n      },\n      checkboxInput(question,e){\n        e.target.checked===true?question.answer=\'yes\':question.answer=\'no\';\n        this.calculateCustomQuestionsButtonDisabled();\n      },\n      openAccountPage(){\n        return window.parent.appointlyClient.openAccountPage();\n      }\n    }\n  })\n  parent.apntlyBookingModal = window.apntlyBookingModal\n  window.addEventListener(\'click\', function (e) {\n    if (e && e.path && !e.path.some(x => x.className && x.className.includes && x.className === \'modal-container\')) {\n      if (parent.appointlyClient.closePopUpOnOutSideClick)\n        window.apntlyBookingModal.closeModal()\n    }\n  }, true)\n  openAccountPage=function (){\n    window.apntlyBookingModal.openAccountPage()\n  }\n\n  if (window.parent.appointlyClient.isEmbedded()) {\n    setInterval(() => {\n      parent.document.getElementById(\'apntly-booking-iframe\').style.height =\n        document.querySelector(".modal-container").scrollHeight + 40 + \'px\';\n    }, 500);\n  }\n\n</script>\n</body>\n</html>\n',
popUpSelector:"apntly-booking-iframe"},customCss:".apntly-modal {\n  position: fixed;\n  height: 100%;\n  width: 100%;\n  top: 0;\n  left: 0;\n  z-index: 999999999;\n  overflow: hidden;\n  visibility: hidden;\n}\n\n#apntly-book-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n}\n\n.apntly-float-button {\n  border-radius: 5px 5px 0 0;\n  top: 30%;\n  position: fixed !important;\n  right: 0;\n  z-index: 1000;\n  border: none;\n  padding: 10px 20px;\n  font-size: 14px;\n  cursor: pointer;\n  font-weight: bold;\n  -webkit-transform: rotate(\n    270deg);\n  -webkit-transform-origin: 100% 100%;\n  -moz-transform: rotate(270deg);\n  -moz-transform-origin: 100% 100%;\n  -ms-transform: rotate(270deg);\n  -ms-transform-origin: 100% 100%;\n  -o-transform: rotate(270deg);\n  -o-transform-origin: 100% 100%;\n  transform: rotate(\n    270deg);\n}\n\nform #apntly-book-button ~ .shopify-payment-button {\n  display:none;\n}\n\n.apntly-float-button {\n  color: #ffffff;\n  background-color: #AF4B4B;\n}\n\n\n",customJs:"",removeFieldsOnCartPageJs:"",clientTimezone:"Europe/Paris",addToCartSelector:"",bookingButtonContainer:"",widgetSettings:{text:"SCHEDULE YOUR TIME"},floatWidgetSettings:{text:"BOOK APPOINTMENT",isEnabled:!1,textColor:"#ffffff",onClickAction:1,backgroundColor:"#AF4B4B"},bookingInfoSettings:{dateText:"Date",timeText:"Time",teamMemberText:"Employee",bookingTimeText:"Booking"},depositPaymentSettings:{createdAtTimeStamp:"1690557271018",shouldDelete:!1,isEnabled:!1,options:[],uniqueId:"2GB889CAQPBCNE28265HQ88M",depositPaymentScreenInfoSettings:{headingText:"Payment Options (Pay Deposit amount now, and remaining after the appointment): "},checkoutInfoText:{titleText:"Deposit for Service",remainingAmountText:"Remaining Balance before Tax and Shipping"},id:16495,createdAt:"2023-07-28T15:14:31.032Z",updatedAt:"2023-07-28T15:14:31.032Z",clientId:17937},productId:"",bookingId:"",subscriptionId:"",auth:"",removeUnAvailableDays:!0,parseVariantFromUrl:!0,isManualBooking:!1,slotsTimeFormat:"hh:mm A",startTimeGapInterval:15,applyBufferTimeOnUnBookedSot:!1,addLoginLink:!0,freeBookingPhoneFieldEnabled:!1,hideDefaultVariant:!1,hideEndTime:!1,showModalCart:!1,isAdmin:!1,showAvailabilityInClientTimezone:!1},window.appointlyClient?console.log("Appointly Client Already Added, Skipping"):(window.AppointlyBookingClient=function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(i,o,function(e){return t[e]}.bind(null,o));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(module,exports,__webpack_require__){"use strict";var __awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,a){function s(t){try{l(i.next(t))}catch(t){a(t)}}function r(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,r)}l((i=i.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0}),exports.AppointlyBookingClient=void 0;const ApoointlyEnums_1=__webpack_require__(1),AppointlyProcessData_1=__webpack_require__(2);let nanoid=__webpack_require__(3);class AppointlyBookingClient{constructor(){this.dateFormat="DD-MM-YYYY HH:mm",this.bookingDataForAllServices={},this.variantSubscriptionData={},this.ignoreProcessNonBookingCartItems=!1,this.variantInputSelectors=["input[name=data-product-id]","input.product-variant-id"],this.dataPageProductId="data-page-product-id",this.dataATCButtonProductId="data-atc-btn-product-id",this.embeddedWidgetContainerSelector="#apntly-embed-widget-container-id",this.cartRowSelector=".cart__row",this.cartQtySelector=".cart__qty",this.cartHideQuantity=!1,this.removeFieldsOnCartPageJsAdded=!1,this.isRequestSent={},this.removeDuplicateSlots=!1,this.autoAssignSlots=!1,this.slotAssignData={},this.listenCartEvents=!1,this.previousRemoveUnavailableDaysKey="",this.removeUnAvailableDaysObj={},this.isFirstTimeDateSelected=!1,this.removeUnAvailableDaysLimit=90,this.isCdnCacheQueryCompleted=!1,this.dateFromTimestampStartBrowserFormat="ll",this.localeBrowserFormat="en",this.isJointGroupAvailability=!1,this.startTimeGapIntervalIfIncrDef=5,this.checkingIfCustomQuestionIsFilled=!1,this.timeSlotMetaEnabled=!1,this.processingAddToCart=!1,this.ignoreAddingPropertiesToCart=!1,this.skipCartPage=!1,this.openCartDrawer=!1,this.cartDrawerSelector="a[href='/cart']",this.integratedAppList=[],this.defaultCountry="",this.skipDepositScreen=!1,this.fpSelector=".featured-product",this.fpIAESelector="button[name=add]",this.fpHESelector="button[name=add]",this.fpBT="SCHEDULE YOUR TIME",this.fpCN="",this.cpCSelector=".product-card-wrapper",this.cpHESelector=".quick-add",this.cpIAESelector=null,this.cpCN="","undefined"!=typeof window&&(this.window=window),this.freeBookingUniqueId=this.getUniqueId(),console.log("Init Appointly Cleint")}loadAppointlyMomentModule(){return __awaiter(this,void 0,void 0,function*(){try{eval(yield(yield fetch(`${this.config.apiUrl}/api/js/moment-timezone-module.min.js?v=1680608145096-cdn&h=${encodeURIComponent(this.window.location.host)}`)).text()),this.window.momentInstance=this.window.AppointlyMomentModule.default.getMomentInstance(),this.dateLib=this.window.momentInstance,this.moment=this.dateLib,this.window.appointlyMomentLoaded=!0}catch(t){this.logToServer("Error getting Moment Module from fetch "+t.message)}})}assignDateLib(){return __awaiter(this,void 0,void 0,function*(){if(this.window.appointlyMomentLoaded&&this.dateLib)return;if(["U551CNMAT7SY7XVCTQL33IFW","4JJ3B2R4C7WPWRZVAT6UM3N3"].some(t=>t===this.config.clientUniqueId))return void(yield this.loadAppointlyMomentModule());let t=new Promise((t,e)=>{const n=document.createElement("script");n.setAttribute("src","https://d3emjguzbsq9q3.cloudfront.net/appointly/api/js/moment-timezone-module.min.js?v=1680608145096-cdn"),n.setAttribute("defer",""),n.onload=(()=>__awaiter(this,void 0,void 0,function*(){this.window.AppointlyMomentModule&&this.window.AppointlyMomentModule.default&&(this.window.momentInstance=this.window.AppointlyMomentModule.default.getMomentInstance()),this.window.momentInstance&&this.window.momentInstance.tz||(yield this.sleep(2e3),this.dateLib&&this.dateLib.tz||(this.loadAppointlyMomentModule(),this.logToServer("moment js not loading directly"))),t()})),document.head.appendChild(n)});yield Promise.all([t]),this.dateLib=this.window.momentInstance,this.moment=this.dateLib,this.window.appointlyMomentLoaded=!0})}getUniqueId(t=24){return nanoid("123456789ABCDEFGHIJKLMNPQRSTUVWXYZ",t)}refresh(){this.removePopUp(this.config.booking.popUpSelector),this.bookingDataForAllServices={},this.window.appointlyClient=new AppointlyBookingClient,this.window.appointlyClient.init(this.window.appointlyConfig)}init(t){return __awaiter(this,void 0,void 0,function*(){this.config=t,!0!==this.config.isAdmin&&(this.config.isAdmin=!1),!0===(yield this.isClientActive())&&(this.getDefaultCountry(),this.addStyles(),this.removeFieldsOnCartPage(),yield this.getService(null),yield this.parseButtonOnShopifyPage(),this.config.isAdmin||window.location.host.includes("apntly.com")||(yield this.addFloatButton()),yield this.assignDateLib(),this.processCartBooking().catch(t=>this.log("Error checking Cart Bookings "+t.message)),this.addCartListeners(),(yield this.isClientActive())&&this.processClientActiveEvent())})}log(t,...e){this.getValueIfExist(()=>this.window.location.href.includes("log=true")||this.config.isAdmin||"true"===this.getCookie("apntly-log"))&&(document.cookie="apntly-log=true;max-age=31104000;path=/",console.log(t,...e||[]))}logToServer(t){return __awaiter(this,void 0,void 0,function*(){try{yield yield fetch(this.getUrl("/api/jsLog"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:`${this.window.Shopify.shop} | ${t} | ${this.window.location.href}`})})}catch(t){this.log("Error during server Log",t)}})}getCookie(t){let e=document.cookie,n={},i=e.split(";");if(""!==i[0]||void 0!==i[0][0])return i.forEach(t=>{let e=t.split(/=(.+)/);" "===e[0].substr(0,1)&&(e[0]=e[0].substr(1)),n[e[0]]=e[1]}),""!==t?n[t]:n}removeCartItem(t){return __awaiter(this,void 0,void 0,function*(){yield(yield fetch("/cart/change.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,quantity:0})})).json()})}processCartBooking(){return __awaiter(this,void 0,void 0,function*(){let t=yield this.isClientActive(),e=yield(yield fetch("/cart.js")).json(),n=e.items.filter(t=>this.getValueIfExist(()=>"Appointly"===t.properties._booking_by&&t.properties._add_to_cart_at<this.dateLib.tz(this.getCurrentTimeStamp(),this.getBrowserTimezone()).subtract(60,"minutes").valueOf()));if(this.log("InValidCartItemsBookings",n),n.length)for(let t of n)this.logToServer("Removing CartItem "+t.properties._add_to_cart_at),yield this.removeCartItem(t.key);if(n.length&&window.location.reload(),t&&!(this.ignoreProcessNonBookingCartItems||e.items.filter(t=>this.getValueIfExist(()=>"Appointly"===t.properties._booking_by)).length>0)){let t=[];for(let n of e.items){let e=n.product_id;(yield this.isServiceActive(e))&&t.push(n)}if(this.log("InValidCartItems",t),t.length)for(let e of t)this.logToServer("Removing NonBooking CartItem: Booking Meta Not Exist ServiceId:"+e.product_id),yield this.removeCartItem(e.key);t.length&&window.location.reload()}})}parseButtonOnShopifyPage(){return __awaiter(this,void 0,void 0,function*(){if(this.isEmbedded()){let t=document.querySelector(this.embeddedWidgetContainerSelector),e=this.getValueIfExist(()=>Number(t.attributes[this.dataPageProductId].value));return void(this.isValidString(e)&&this.getService(e))}if(!this.service){let t=document.querySelector("#apntly-page-book-button");if(t){let e=this.getValueIfExist(()=>Number(t.attributes[this.dataPageProductId].value));this.isValidString(e)&&(t.addEventListener("click",t=>this.openBookModal(t)),this.getService(e))}}let t=[...document.querySelectorAll(".apntly-page-book-button")];for(let e of t){let t=this.getValueIfExist(()=>Number(e.attributes[this.dataPageProductId].value));this.isValidString(t)&&(e.addEventListener("click",t=>this.openBookModal(t)),this.getService(t))}})}convertTimeZone(t,e,n){let i=this.dateFormat;return this.dateLib.tz(t,i,e).tz(n)}getCurrentTimeStamp(){return this.dateLib().valueOf()}getUrl(t){return`${this.config.apiUrl}${t}`}getServiceForProduct(){fetch(this.getUrl("/api/"))}hideVariantSelector(){this.apntlyBookingModalData.showVariantContainer=!1}hideTeamMemberSelector(){this.apntlyBookingModalData.showTeamMemberContainer=!1}showTeamMemberSelector(){this.apntlyBookingModalData.showTeamMemberContainer=!0}isProductPage(){if(window.location.pathname.includes("product")||window.location.pathname.includes("collection"))return window.location.href.split("?")[0]}getProduct(){return __awaiter(this,void 0,void 0,function*(){if(this.isProductPage()){if(!this.window.appointlyProduct||!this.window.appointlyProduct.variants){let t;try{t=yield(yield fetch(window.location.href.split("?")[0]+".js")).json()}catch(t){console.error("Error in fetching product",t)}t.id&&(this.processProduct(t),this.window.appointlyProduct=t)}return this.window.appointlyProduct}})}processProduct(t){t&&t.variants&&t.variants.forEach&&t.variants.forEach(t=>{t.price=t.price/100})}addPopUp(t,e,n){if(console.debug("addPopup"),document.getElementById(t)&&(this.compareToStringValues(document.getElementById(t).getAttribute("data-product-id"),n)||document.getElementById(t).remove()),!document.getElementById(t)){let i=document.createElement("iframe");i.style.visibility="hidden",i.style.opacity="0",i.style.zIndex="-1",i.setAttribute("data-product-id",n),i.style.border="none",i.id=t,i.className="apntly-modal",document.querySelector(this.embeddedWidgetContainerSelector)?(i.style.position="relative",i.srcdoc=e.replace("is-embed-val","is-embed-true"),i.className=i.className+" is-embed-true",i.scrolling="no",i.frameBorder="0",document.querySelector(this.embeddedWidgetContainerSelector).appendChild(i)):(i.srcdoc=e.replace("is-embed-val","is-embed-false"),document.body.appendChild(i))}}removePopUp(t){document.getElementById(t)&&document.body.removeChild(document.getElementById(t))}addStyles(){this.addStyleElement(this.config.customCss)}addStyleElement(t){let e=document.createElement("style");e.type="text/css",e.innerText=t,document.head.appendChild(e)}addJs(){if(!this.config.customJs)return;let t=document.createElement("script");t.type="text/javascript";let e=document.createTextNode(this.config.customJs);t.appendChild(e),document.head.appendChild(t)}addToCartButtonNotFountEvent(){}addButton(t,e){return __awaiter(this,void 0,void 0,function*(){let n;if(this.productPageServiceExistInitializeEvent(),this.config.addToCartSelector&&(n=document.querySelector(this.config.addToCartSelector)),n||(n=document.querySelector('[name="add"]')||document.querySelector('[data-action="add-to-cart"]')||document.querySelector("[data-add-to-cart]")||document.querySelector(".product-form--add-to-cart")||document.querySelector(".product-form--atc-button")),console.log("Adding Button"),!n)return t<20?(console.log("Add to Cart Button Not found, Retrying"),yield this.sleep(200),void this.addButton(t+1,e)):void this.logToServer("Add to Cart Button Not found");let i=n.className;this.addAddToCartClassesIgnoreList&&(i=i.split(" ").filter(t=>!this.addAddToCartClassesIgnoreList.split(" ").some(e=>e==t)).join(" "));let o=n.parentNode,a=document.createElement("div");if("TUT9HR5MMDXUT2KXSPQJY6E6"===this.config.clientUniqueId&&(a=document.createElement("button")),a.id="apntly-book-button",a.className=i,a.innerText=this.config.widgetSettings.text,a.setAttribute(this.dataATCButtonProductId,e),a.addEventListener("click",t=>this.openBookModal(t)),this.config.bookingButtonContainer?(o.removeChild(n),document.querySelector(this.config.bookingButtonContainer).appendChild(a)):o.replaceChild(a,n),!["949LUJDTEISMV5294RUSH2ZP"].some(t=>t===this.config.clientUniqueId)){let t=document.querySelector("[data-shopify='payment-button']");t&&(t.style.display="none")}this.productPageServiceExistEvent()})}productPageServiceExistInitializeEvent(){}productPageServiceExistEvent(){}isFloatButtonConditionSatisfied(){return!0}addFloatButton(){if((Number(this.config.floatWidgetSettings.onClickAction)!==ApoointlyEnums_1.AppointlyFloatWidgetAction.OpenService||!this.service||!this.isProductPage())&&this.config.floatWidgetSettings.isEnabled&&this.isFloatButtonConditionSatisfied()&&!document.getElementById("apntly-float-button")){let t=document.createElement("button");t.className="apntly-float-button",t.type="button",t.innerText=this.config.floatWidgetSettings.text,document.body.appendChild(t),Number(this.config.floatWidgetSettings.onClickAction)===ApoointlyEnums_1.AppointlyFloatWidgetAction.OpenService?(t.setAttribute(this.dataPageProductId,this.config.floatWidgetSettings.onClickProductId),t.onclick=(t=>this.openBookModal(t)),this.getService(this.config.floatWidgetSettings.onClickProductId)):Number(this.config.floatWidgetSettings.onClickAction)===ApoointlyEnums_1.AppointlyFloatWidgetAction.OpenUrl&&this.config.floatWidgetSettings.onClickUrl&&(t.onclick=(t=>{window.location.href=this.config.floatWidgetSettings.onClickUrl}))}}getSelectedUrlVariantUniqueId(){return __awaiter(this,void 0,void 0,function*(){let t=this.getValueIfExist(()=>Number(new URLSearchParams(window.location.search).get("variant")));if(t)return this.getValueIfExist(()=>this.service.variants.find(e=>Number(e.variantId)===t).uniqueId);let e=t=>this.getValueIfExist(()=>(t=>[...document.querySelectorAll(`[data-index="option${t}"]`)||document.querySelectorAll("#Option-product-"+(t-1))])(t).find(t=>"radio"===t.type&&!0===t.checked||"radio"!==t.type).value),n=(yield e(1))||null,i=(yield e(2))||null,o=(yield e(3))||null;console.log(n,i,o);let a=((yield this.getProduct())||{variants:[]}).variants.find(t=>t.option1===n&&t.option2===i&&t.option3===o);if(console.log(a),t=a&&a.id,!t){let e=this.getValueIfExist(()=>this.variantInputSelectors.filter(t=>document.querySelector(t)).map(t=>Number(document.querySelector(t).getAttribute("value"))).filter(t=>!!t));t=this.getValueIfExist(()=>e.find(t=>this.service.variants.find(e=>Number(e.variantId)===Number(t))))}if(!t){let e=((yield this.getProduct())||{variants:[]}).variants[0];t=e&&e.id}return this.getValueIfExist(()=>this.service.variants.find(e=>Number(e.variantId)===t).uniqueId)})}openBookModal(t){return __awaiter(this,void 0,void 0,function*(){this.isFirstTimeDateSelected=!1,this.apntlyBookingModalData&&(this.apntlyBookingModalData.cartItems=[],this.apntlyBookingModalData.screen=1);let e=this.getValueIfExist(()=>Number(t.target.attributes[this.dataPageProductId].value))||this.getValueIfExist(()=>Number(t.target.attributes[this.dataATCButtonProductId].value));if(t&&this.isValidString(e)&&(t.target.setAttribute("initial-name",t.target.getAttribute("initial-name")||t.target.innerText),!this.service||!this.compareToStringValues(this.service.productId,e)))return t.target.innerText="Loading Service...",this.getService(e),yield this.waitTillModalNotAdded(e),yield this.sleep(500),this.getService(e),t.target.innerText=t.target.getAttribute("initial-name"),this.openBookModal(t);if(!this.service)return;this.config.hideDefaultVariant&&1===this.service.variants.length&&this.getValueIfExist(()=>"default title"===this.service.variants[0].title.toLowerCase())&&this.hideVariantSelector();let n=this.getValueIfExist(()=>Number(t.target.attributes[this.dataPageProductId].value));if(this.isValidString(n)&&console.log("PageProductId",n),document.getElementById(this.config.booking.popUpSelector).style.visibility="visible",document.getElementById(this.config.booking.popUpSelector).style.opacity="1",document.getElementById(this.config.booking.popUpSelector).style.zIndex="999999999",!0===this.config.parseVariantFromUrl){let t=yield this.getSelectedUrlVariantUniqueId();this.apntlyBookingModalData.variants.find(e=>e.value===t)?(this.apntlyBookingModalData.selectedVariant=t,this.apntlyBookingModalData.variantKey="vk-"+(new Date).valueOf(),console.log("Parsed Variant Automatically",this.apntlyBookingModalData.selectedVariant),this.onSelectionChange()):console.log("Can't parse Variant Automatically")}})}closeBookModal(){document.getElementById(this.config.booking.popUpSelector).style.visibility="hidden",document.getElementById(this.config.booking.popUpSelector).style.opacity="0",document.getElementById(this.config.booking.popUpSelector).style.zIndex="-1"}waitTillModalNotAdded(t){return __awaiter(this,void 0,void 0,function*(){for(;!this.window.apntlyBookingModal||!document.getElementById(this.config.booking.popUpSelector)||!this.compareToStringValues(document.getElementById(this.config.booking.popUpSelector).getAttribute("data-product-id"),t);)yield this.sleep(300),console.debug("Waiting For booking Modal Availability")})}getValueIfExist(t){try{return t()}catch(t){return}}getValueIfExistAsync(t,e,n){return __awaiter(this,void 0,void 0,function*(){try{return yield t()}catch(t){return e&&this.log(t),void(n&&this.logToServer(`${n} ${t.message}`))}})}removeFieldsOnCartPage(){return __awaiter(this,void 0,void 0,function*(){try{if(this.config.removeFieldsOnCartPageJs&&this.config.removeFieldsOnCartPageJs.trim()&&!this.removeFieldsOnCartPageJsAdded){this.removeFieldsOnCartPageJsAdded=!0;let t=document.createElement("script");t.type="text/javascript";let e=document.createTextNode(this.config.removeFieldsOnCartPageJs);t.appendChild(e),document.head.appendChild(t)}this.window.location.pathname.includes("cart")&&(yield(yield fetch("/cart.js")).json()).items.filter(t=>this.getValueIfExist(()=>"Appointly"===t.properties._booking_by)).length>0&&this.window.location.pathname.includes("cart")&&(document.querySelectorAll(".product-details__item.product-details__item--property")&&[...document.querySelectorAll(".product-details__item.product-details__item--property")].map(t=>this.getValueIfExist(()=>t.children[0].innerText.startsWith("_"))?t.style.display="none":""),document.querySelectorAll(this.cartRowSelector)&&this.cartHideQuantity&&this.config.bookingInfoSettings.bookingTimeText&&this.config.bookingInfoSettings.bookingTimeText.trim()&&this.getValueIfExist(()=>{[...document.querySelectorAll(this.cartRowSelector)].filter(t=>t.innerHTML&&t.innerHTML.includes(this.config.bookingInfoSettings.bookingTimeText+":")).map(t=>[...t.querySelectorAll(this.cartQtySelector)].map(t=>t.style.display="none"))}))}catch(t){console.error(t)}})}getBookingData(t){return __awaiter(this,void 0,void 0,function*(){for(;this.isRequestSent[t];)yield this.sleep(500);setTimeout(()=>{this.isRequestSent[t]=!1},1e4),this.isRequestSent[t]=!0;let e=this.bookingDataForAllServices[t]||(yield(yield fetch(this.getUrl(`/api/service/${t}/bookingData`),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:t,clientUniqueId:this.config.clientUniqueId})})).json());return this.bookingDataForAllServices[t]=e,this.isRequestSent[t]=!1,e})}getCalenderEvents(t,e){return __awaiter(this,void 0,void 0,function*(){return(yield(yield fetch(this.getUrl("/api/service/all/bookingData/teamMemberCalenderEvents/"+t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:"all",clientUniqueId:this.config.clientUniqueId,teamMemberUniqueId:t,startTimeStamp:e})})).json()).events})}getService(t){return __awaiter(this,void 0,void 0,function*(){let e=t,n=!1;if(!t)if(this.config.productId)t=this.config.productId;else{let e=yield this.getProduct();if(!e)return;n=!0,t=e.id}if("product"===t)return yield this.sleep(100),yield this.getService(e);if(!this.config.isAdmin&&!(yield this.isServiceActive(t)))return;this.addPopUp(this.config.booking.popUpSelector,this.config.booking.bookingHtml,t),n&&this.addButton(0,t);let i=setTimeout(()=>this.logToServer("Moment Not loaded after 10 seconds"),1e4);yield this.assignDateLib(),clearTimeout(i);let o=yield this.getBookingData(t);if(o.service&&(this.config.isAdmin||o.service.isActive)){if(yield this.waitTillModalNotAdded(t),console.log("Appointly Modal Data",this.window.apntlyBookingModal.$data),yield this.addJs(),console.log(o),this.apntlyBookingModalData=this.window.apntlyBookingModal.$data,this.bookingData=o,this.service=o.service,(document.querySelector(this.embeddedWidgetContainerSelector)||"open"===this.getValueIfExist(()=>new URLSearchParams(window.location.search).get("calender")))&&this.openBookModal(null),this.apntlyBookingModalData.variants=this.service.variants.map(t=>({text:t.title,value:t.uniqueId})),this.apntlyBookingModalData.selectedVariant=this.apntlyBookingModalData.variants[0].value,this.config.bookingId){console.log("Booking Id Exist",this.config.bookingId);let t=yield(yield fetch(this.getUrl(`/api/bookings/${this.config.bookingId}?auth=${this.config.auth}`),{method:"GET",headers:{"Content-Type":"application/json"}})).json();this.previousAppointmentData=t;let e=this.service.variants.find(t=>t.uniqueId===this.previousAppointmentData.serviceVariant.uniqueId);e&&(this.apntlyBookingModalData.selectedVariant=e.uniqueId),this.apntlyBookingModalData.variantEmployees=e.teamMembers.map(t=>({text:t.name,value:t.uniqueId})),this.apntlyBookingModalData.selectedEmployee=t.teamMember.uniqueId}this.config.subscriptionId&&(this.hideVariantSelector(),this.apntlyBookingModalData.selectedVariant=this.window.subVar,this.apntlyBookingModalData.selectedEmployee=this.window.subEmp),this.apntlyBookingModalData.variantKey="vk-"+(new Date).valueOf(),yield this.onSelectionChange()}})}processCartUpdate(){return __awaiter(this,void 0,void 0,function*(){yield this.processCartBooking(),yield this.removeFieldsOnCartPage()})}addCartListeners(){return __awaiter(this,void 0,void 0,function*(){if(this.listenCartEvents)try{if(this.config.clientUniqueId&&this.window.isApntlyFetchInterceptorAdded)return;this.window.isApntlyFetchInterceptorAdded=!0,t=window,e=window.fetch,"function"==typeof e&&(t.fetch=function(){const t=e.apply(this,arguments);return t.then(t=>{t.url&&[window.location.origin+"/cart/add",window.location.origin+"/cart/update",window.location.origin+"/cart/change",window.location.origin+"/cart/clear"].some(e=>t.url.includes(e))&&(window.appointlyClient.log("Cart Request "+t.url),window.appointlyClient.getValueIfExistAsync(()=>window.appointlyClient.processCartUpdate(),!0,"ProcessCartUpdateFromFetchIntercept"))}),t})}catch(t){this.logToServer("Error in Cart Update Interceptor "+t.message)}var t,e})}onSelectionChange(){return __awaiter(this,void 0,void 0,function*(){this.bookingData.dataTimestamp<this.dateLib.tz(this.getCurrentTimeStamp(),this.getBrowserTimezone()).subtract(30,"minutes").valueOf()&&(console.log("Getting new data"),this.bookingDataForAllServices[this.service.productId]=null,this.bookingData=yield this.getBookingData(this.service.productId)),this.apntlyBookingModalData.isLoading=!0,this.showModalCart()||1===this.apntlyBookingModalData.screen&&(this.apntlyBookingModalData.cartItems=[],this.isBookNowButtonDisabled());let t=this.apntlyBookingModalData.selectedVariant,e=this.service.variants.find(e=>e.uniqueId===t);e||(e=this.service.variants[0]),this.isSubscriptionAppointment(e.uniqueId)&&(this.variantSubscriptionData[e.uniqueId]=yield this.getSubscriptionBookingData(e.uniqueId),yield this.getSubscriptionAppointmentMessage(),this.isBookNowButtonDisabled()),this.apntlyBookingModalData.variantEmployees=e.teamMembers.map(t=>({text:t.name,value:t.uniqueId})),this.apntlyBookingModalData.variantEmployees.find(t=>t.value===this.apntlyBookingModalData.selectedEmployee)||(this.apntlyBookingModalData.selectedEmployee=this.apntlyBookingModalData.variantEmployees[0].value),this.apntlyBookingModalData.employeeKey="ek-"+(new Date).valueOf();let n=e.teamMembers.find(t=>t.uniqueId===this.apntlyBookingModalData.selectedEmployee),i=[],o=this.getSelectedDate(),a=[];a=this.mergeTeamMemberSlots()?e.teamMembers:[n];for(let t of a){let n=this.getTeamMemberData(e,t),a=yield this.getFreeSlots(n.bookedSlots,n.events,e,t,n.availability,this.config.clientTimezone,this.getBrowserTimezone(),o,!1);i.push(...a)}if(a.length>1){if(this.removeDuplicateSlots){let t=[];for(let e of i)if(-1===t.findIndex(t=>t.bookingTimestamp===e.bookingTimestamp)){let n=i.filter(t=>t.bookingTimestamp===e.bookingTimestamp&&t.available),o=n[0];this.autoAssignSlots&&o&&(a.forEach(t=>{this.slotAssignData[t.uniqueId]=this.slotAssignData[t.uniqueId]||0}),i.filter(t=>t.bookingTimestamp===e.bookingTimestamp&&!t.available).forEach(t=>{this.slotAssignData[t.employee.uniqueId]++}),o=n.sort((t,e)=>this.slotAssignData[t.employee.uniqueId]-this.slotAssignData[e.employee.uniqueId])[0]),o?t.push(o):t.push(e)}i=[...t]}i=i.sort((t,e)=>this.dateLib.tz(t.clientStart,this.config.clientTimezone).valueOf()-this.dateLib.tz(e.clientStart,this.config.clientTimezone).valueOf())}this.apntlyBookingModalData.timeSlots=[],this.apntlyBookingModalData.timeSlots=i,this.apntlyBookingModalData.timeSlotKey="ek-"+(new Date).valueOf(),this.config.removeUnAvailableDays&&(yield this.removeUnAvailableDays()),this.apntlyBookingModalData.isLoading=!1})}getTeamMemberAvailability(t){return this.config.isAdmin&&this.apntlyBookingModalData.showAllSlots?this.getAlwaysAvailiableTimings():this.bookingData.availabilities.find(e=>e.id===t.availiabilityId)}getTeamMemberBookings(t){return this.config.isAdmin&&this.apntlyBookingModalData.ignoreBookedSlots?[]:this.bookingData.teamMembers.find(e=>e.uniqueId===t.uniqueId).bookings}getTeamMemberEvents(t){return this.config.isAdmin&&this.apntlyBookingModalData.ignoreBookedSlots?[]:this.bookingData.teamMembers.find(e=>e.uniqueId===t.uniqueId).events}getAlwaysAvailiableTimings(){let t={};return t.weekDayAvailabilities=[{weekDay:ApoointlyEnums_1.AppointlyWeekDay.Sunday,slots:[{start:"00:15",end:"23:45"}]},{weekDay:ApoointlyEnums_1.AppointlyWeekDay.Monday,slots:[{start:"00:15",end:"23:45"}]},{weekDay:ApoointlyEnums_1.AppointlyWeekDay.Tuesday,slots:[{start:"00:15",end:"23:45"}]},{weekDay:ApoointlyEnums_1.AppointlyWeekDay.Wednesday,slots:[{start:"00:15",end:"23:45"}]},{weekDay:ApoointlyEnums_1.AppointlyWeekDay.Thursday,slots:[{start:"00:15",end:"23:45"}]},{weekDay:ApoointlyEnums_1.AppointlyWeekDay.Friday,slots:[{start:"00:15",end:"23:45"}]},{weekDay:ApoointlyEnums_1.AppointlyWeekDay.Saturday,slots:[{start:"00:15",end:"23:45"}]}],t.specialDayAvailabilities=[],t}isAdmin(){return this.config.isAdmin}getTeamMemberData(t,e){let n=this.getTeamMemberAvailability(e);this.apntlyBookingModalData.maxDate=this.dateLib.tz(this.getCurrentTimeStamp(),this.getBrowserTimezone()).add(Number(t.maxFutureDayNo),"days").toDate(),this.config.isAdmin&&this.apntlyBookingModalData.showAllSlots&&(this.apntlyBookingModalData.maxDate=null);let i=this.getTeamMemberBookings(e),o=this.getTeamMemberEvents(e);return this.config.bookingId&&(i=i.filter(t=>t.uniqueId!==this.config.bookingId)),{bookedSlots:i,events:o,availability:n}}setIsFirstTimeDateSelected(t){this.isFirstTimeDateSelected=t}removeUnAvailableDays(){return __awaiter(this,void 0,void 0,function*(){this.apntlyBookingModalData.disabledDates=[],this.apntlyBookingModalData.availableDates=[];let t=[],e=this.apntlyBookingModalData.selectedVariant,n=this.service.variants.find(t=>t.uniqueId===e);n||(n=this.service.variants[0]);let i=n.teamMembers.find(t=>t.uniqueId===this.apntlyBookingModalData.selectedEmployee),o=[];o=this.mergeTeamMemberSlots()?n.teamMembers:[i];let a=`${n.uniqueId}-${o.map(t=>t.uniqueId).join("-")}-firstAvailable`,s=this.removeUnAvailableDaysObj[a],r=!0,l=null,d=null;s&&(r=!1,l=this.getValueIfExist(()=>this.window.apntlyBookingModal.$refs.datep.$refs.calendar.getPageDays().find(t=>t.inMonth).month),d=this.getValueIfExist(()=>this.window.apntlyBookingModal.$refs.datep.$refs.calendar.getPageDays().find(t=>t.inMonth).year));let c=`${n.uniqueId}-${o.map(t=>t.uniqueId).join("-")}-${l}-${d}`;if(this.removeUnAvailableDaysObj[c])return this.apntlyBookingModalData.disabledDates=this.removeUnAvailableDaysObj[c],void(s&&(window.location.href.includes("product")||this.moveToFirstAvailableDate(s,r)));yield this.sleep(100),console.log("Removing Unavailable dates: "+c);let p=this.dateLib.tz(new Date,this.getBrowserTimezone()).subtract(1,"days");l&&(p=this.dateLib.tz(`01-${l<10?"0":""}${l}-${d}`,"DD-MM-YYYY",this.getBrowserTimezone()));let u=0,m=this.removeUnAvailableDaysLimit;l&&(m=31);let h=this.dateLib.tz(this.apntlyBookingModalData.selectedDate,this.getBrowserTimezone()).endOf("month").diff(p.clone().add(90,"days"),"days");for(h>0&&h<=31&&(console.log("daysToAddFromFirstAvailableDate",h),m=m+h+1),"2MYNK9LEDA2668TM9IE5WUN5"===this.config.clientUniqueId&&(m=500);u<m;){let e=[];for(let t of o){let i=this.getTeamMemberData(n,t),o=yield this.getFreeSlots(i.bookedSlots,i.events,n,t,i.availability,this.config.clientTimezone,this.getBrowserTimezone(),p.format("DD-MM-YYYY"),!0);if(o=o.filter(t=>!0===t.available),o.length>0&&!s&&(s=p.toDate(),this.removeUnAvailableDaysObj[a]=s,console.log("firstAvailableDate",s)),o.length>0){this.apntlyBookingModalData.availableDates.push({start:new Date(p.year(),p.month(),p.date()),end:new Date(p.year(),p.month(),p.date())}),e.push(...o),p.format("DD-MM-YYYY")===this.getSelectedDate()&&(r=!1);break}}0===e.length&&t.push(new Date(p.year(),p.month(),p.date())),
p=p.add(1,"day"),u++}this.apntlyBookingModalData.disabledDates=t,this.removeUnAvailableDaysObj[c]=this.apntlyBookingModalData.disabledDates,this.moveToFirstAvailableDate(s,r)})}moveToFirstAvailableDate(t,e){this.isFirstTimeDateSelected||(e=!0,this.isFirstTimeDateSelected=!0);let n=new Date(this.dateLib.tz(t,this.getBrowserTimezone()).year(),this.dateLib.tz(t,this.getBrowserTimezone()).month(),this.dateLib.tz(t,this.getBrowserTimezone()).date()),i=new Date(this.dateLib.tz(this.getCurrentTimeStamp(),this.getBrowserTimezone()).year(),this.dateLib.tz(this.getCurrentTimeStamp(),this.getBrowserTimezone()).month(),this.dateLib.tz(this.getCurrentTimeStamp(),this.getBrowserTimezone()).date()),o=Math.abs(this.dateLib.tz(n,this.getBrowserTimezone()).diff(this.dateLib.tz(i,this.getBrowserTimezone()),"days")),a=Number(this.getSelectedVariant().maxFutureDayNo||0);o>a?console.log(`Not Setting First Available Date because Difference In days is greater than Max Future Days  Diff:${o} MaxFutureDay:${a}`):t&&e&&(console.log("Selecting First Available Date "+this.dateLib.tz(t,this.getBrowserTimezone()).format()+" Diff:"+o),this.apntlyBookingModalData.selectedDate=n,this.apntlyBookingModalData.calendarKey="ck-"+(new Date).valueOf(),this.onSelectionChange())}getIsActiveVersions(){let t=[];t.push((new Date).valueOf());let e=[];for(let n of t){let t=`/api/cached-data/client/${this.config.clientUniqueId}/${n}/isActive.json?v=${n}&h=${encodeURIComponent(this.config.clientUniqueId)}`;e.push(`${this.config.apiUrl}${t}`)}return e}isServiceActiveByCdnData(t,e,n){return __awaiter(this,void 0,void 0,function*(){if(!this.isValidString(t))return;let i=this.getIsActiveVersions();n&&(i=i.sort((t,e)=>(t.includes("stlf")?0:1)-(e.includes("stlf")?0:1)));let o=!1;for(let n of i){let i=yield this.getValueIfExistAsync(()=>__awaiter(this,void 0,void 0,function*(){return yield(yield fetch(n,{headers:{"accept-encoding":"gzip"}})).text()}),!0,"Error Getting CDN_IS_ACTIVE_DATA "+n);if(i&&i.includes("isActive")||this.logToServer("Error Getting CDN_IS_ACTIVE_DATA "+n),i&&i.includes("isActive")){let n=JSON.parse(i),a=!0===n.isActive;if("client"===t&&(o=!0),a&&n.activeServiceProductIds.some(e=>Number(e)===Number(t))&&(o=!0),!e)break}}return o})}isClientActive(){return __awaiter(this,void 0,void 0,function*(){try{if(this.window.activeServiceProductIds&&this.window.activeServiceProductIds.length>0)return this.isCdnCacheQueryCompleted||(this.isServiceActiveByCdnData("client",!1,!1),this.isCdnCacheQueryCompleted=!0),!0;const t="undefined"!=typeof AbortController?new AbortController:{abort(){},signal:null},e=setTimeout(()=>t.abort(),5e3);let n=yield(yield fetch(this.getUrl("/api/client/isActive"),Object.assign({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientUniqueId:this.config.clientUniqueId})},"undefined"!=typeof AbortController?{signal:t.signal}:{}))).json();clearTimeout(e);let i=!0===n.isActive;return i&&(this.window.activeServiceProductIds=n.activeServiceProductIds),this.isServiceActiveByCdnData("client",!1,!1),i}catch(t){return this.logToServer("Cant get IsActiveData ProductId:client "+t.message),this.isServiceActiveByCdnData("client",!1,!0)}})}processClientActiveEvent(){return __awaiter(this,void 0,void 0,function*(){})}isServiceActive(t){return __awaiter(this,void 0,void 0,function*(){if(this.window.activeServiceProductIds&&this.window.activeServiceProductIds.length>0&&this.window.activeServiceProductIds.some(e=>Number(e)===Number(t)))return!0;try{const e="undefined"!=typeof AbortController?new AbortController:{abort(){},signal:null},n=setTimeout(()=>e.abort(),5e3);let i=yield(yield fetch(this.getUrl(`/api/service/${t}/isActive`),Object.assign({method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:t,clientUniqueId:this.config.clientUniqueId})},"undefined"!=typeof AbortController?{signal:e.signal}:{}))).json();return clearTimeout(n),!0===i.isActive}catch(e){return this.logToServer(`Cant get IsActiveData ProductId:${t} ${e.message}`),yield this.assignDateLib(),yield this.isServiceActiveByCdnData(t,!1,!0)}})}getBrowserTimezone(){return this.config.showAvailabilityInClientTimezone?this.config.clientTimezone:this.getCustomerTimeZone()}getCustomerTimeZone(){return Intl.DateTimeFormat().resolvedOptions().timeZone}getSelectedDate(){return this.config.showAvailabilityInClientTimezone?this.dateLib(this.apntlyBookingModalData.selectedDate).format("DD-MM-YYYY"):this.dateLib.tz(this.apntlyBookingModalData.selectedDate,this.getBrowserTimezone()).format("DD-MM-YYYY")}getSelectedDateBrowserFormatted(){return this.dateLib.tz(this.apntlyBookingModalData.selectedDate,this.getBrowserTimezone()).format("ll")}importLocale(cdnLink){return __awaiter(this,void 0,void 0,function*(){"en"!==this.dateLib.locale()&&this.logToServer("IMPORT_LOCALE: Moment default locale is not en");let locale=(yield(yield fetch(cdnLink)).text()).replace("e.moment","e.dateLib");eval(locale),this.dateLib.locale("en")})}getDateFromTimestampStartBrowserFormatted(t){return"en"===this.localeBrowserFormat&&"en"!==this.dateLib.locale()&&this.logToServer("Moment locale is not en, but we used en locale"),this.dateLib.tz(t,this.getBrowserTimezone()).locale(this.localeBrowserFormat).format(this.dateFromTimestampStartBrowserFormat)}sleep(t){return __awaiter(this,void 0,void 0,function*(){return new Promise(e=>{setTimeout(()=>{e()},t)})})}checkIfEmailValid(t){return t&&/\S+@\S+\.\S+/.test(t)}checkIfPhoneNumberValid(t){return t=t.replace(/-/g,"").replace(/ /g,"").replace(/\(/g,"").replace(/\)/g,""),!(Number.isNaN(t)||parseInt(t)!==Number(t)||parseInt(t)<100)}isPhoneFieldEnabledInFreeBooking(){return this.config.freeBookingPhoneFieldEnabled}showServiceDurationInBookedSlot(){return!1}isRescheduleEvent(){return this.config.bookingId}mergeTeamMemberSlots(){let t=this.serviceMergeTeamMemberEnabled();return t&&this.isAdmin()&&(t=this.apntlyBookingModalData.adminMergeTeamMember),t?this.hideTeamMemberSelector():this.showTeamMemberSelector(),t}serviceMergeTeamMemberEnabled(){return this.service&&this.service.mergeTeamMemberSlots}adminSlotChanged(){return __awaiter(this,void 0,void 0,function*(){console.log("admin slot changed"),yield this.sleep(1e3),this.removeUnAvailableDaysObj={},this.onSelectionChange()})}getServiceDuration(t,e){return t.durationInMin}getFreeSlots(t,e,n,i,o,a,s,r,l){return __awaiter(this,void 0,void 0,function*(){if(0===e.length&&AppointlyProcessData_1.AppointlyProcessData.isLargeCalenderEventsExists(this.config.clientUniqueId)&&!l){let t=this.dateLib.tz(r,"DD-MM-YYYY",s).valueOf();e=yield this.getCalenderEvents(i.uniqueId,t)}t=JSON.parse(JSON.stringify(t));try{if(!n.isGroupAppointment){let e=this.window.cartCache||(yield(yield fetch("/cart.json")).json());this.window.cartCache=e;let n=e.items.filter(t=>t.properties&&"Appointly"===t.properties._booking_by).filter(t=>t.properties._employee_unique_id===i.uniqueId).map(t=>({bookingTimestamp:t.properties._booking_start_timestamp,durationInMin:t.properties._booking_duration,noOfSameTimeBooking:1}));n.length&&(l||console.log("BookingsInCart",n),AppointlyProcessData_1.AppointlyProcessData.allowDifferentServiceOnSameTime(this.config.clientUniqueId)||t.push(...n))}}catch(t){}e=JSON.parse(JSON.stringify(e)),n=JSON.parse(JSON.stringify(n)),o=JSON.parse(JSON.stringify(o)),t=t.map(t=>{let e=Object.assign({},t);return e.bookingTimestamp=e.bookingTimestamp-60*n.bufferTimeBefore*1e3,e.durationInMin=Number(e.durationInMin)+n.bufferTimeAfter+n.bufferTimeBefore,e});let d=[],c=n.availability,p=this.dateLib.tz(this.dateLib.tz(r+" 00:00",this.dateFormat,s).subtract(1,"day").format("DD-MM-YYYY")+" 00:01",this.dateFormat,a),u=this.dateLib.tz(this.dateLib.tz(r+" 00:00",this.dateFormat,s).add(1,"day").format("DD-MM-YYYY")+" 23:59",this.dateFormat,a);for(;u.isAfter(p);){let u=p.isoWeekday(),m=[],h=o.specialDayAvailabilities.find(t=>t.day===p.format("DD-MM-YYYY"));if(h)m=h.slots;else{let t=o.weekDayAvailabilities.find(t=>t.weekDay===u);t&&(m=t.slots)}let g=[],f=c.specialDayAvailabilities.find(t=>t.day===p.format("DD-MM-YYYY"));if(f)g=f.slots;else{let t=c.weekDayAvailabilities.find(t=>t.weekDay===u);t&&(g=t.slots)}this.isAdmin()&&this.apntlyBookingModalData.showAllSlots&&(g=this.getAlwaysAvailiableTimings().weekDayAvailabilities.find(t=>t.weekDay===u).slots);let y=[];if(n.isTimingsEnabled)for(let t of m)g.map(e=>{let n=60*Number(e.start.split(":")[0])+Number(e.start.split(":")[1]),i=60*Number(e.end.split(":")[0])+Number(e.end.split(":")[1]),o=60*Number(t.start.split(":")[0])+Number(t.start.split(":")[1]),a=60*Number(t.end.split(":")[0])+Number(t.end.split(":")[1]);o>=n&&a<=i?y.push(t):o<=n&&a>=i?y.push({start:e.start,end:e.end}):o<=n&&a<=i?y.push({start:e.start,end:t.end}):o>=n&&o<=i&&a>=i&&y.push({start:t.start,end:e.end})});else y=m;y=y.sort((t,e)=>60*Number(t.start.split(":")[0])-60*Number(e.end.split(":")[0]));for(let o of y){let c=Number(o.start.split(":")[0]),u=Number(o.start.split(":")[1]),m=this.dateLib.tz(p.clone().format(`DD-MM-YYYY ${c}:${u}`),this.dateFormat,a),h=Number(o.end.split(":")[0]),g=Number(o.end.split(":")[1]),f=this.dateLib.tz(p.clone().format(`DD-MM-YYYY ${h}:${g}`),this.dateFormat,a);if(f.valueOf()<this.dateLib.tz(this.getCurrentTimeStamp(),a).valueOf())continue;let y=60*n.cutoffMins*1e3;this.isAdmin()&&this.apntlyBookingModalData.showAllSlots&&(y=0),m.valueOf()<this.dateLib.tz(this.getCurrentTimeStamp(),a).valueOf()+y&&(m=this.dateLib.tz(this.dateLib.tz(this.getCurrentTimeStamp(),a).valueOf()+y,a).seconds(0).milliseconds(0));let b=[];if(n.startTimeIncrementInMin>0&&this.config.startTimeGapInterval>5&&(this.config.startTimeGapInterval=this.startTimeGapIntervalIfIncrDef),this.config.startTimeGapInterval>0){let t=0;for(;t<=60;)b.push(t),t+=this.config.startTimeGapInterval}for(;m<f;){if(this.config.startTimeGapInterval>0){let t=Number(m.clone().format("mm"));if(!b.some(e=>e===t)){let e=b.find(e=>e>t)-t;m=this.dateLib.tz(m.valueOf()+60*e*1e3,a),m.isValid()||console.error("Start Time is not valid")}}let o=this.getServiceDuration(n,{clientStartTime:m,clientEndTime:f});if(m.clone().add(o,"minutes").valueOf()<=f.valueOf()){let c,p=this.convertTimeZone(m.format(this.dateFormat),a,s);if(p.format("DD-MM-YYYY")===r){let r=!1,u=0,h=AppointlyProcessData_1.AppointlyProcessData.isJointGroupAvailability(this.config.clientUniqueId)||this.isJointGroupAvailability;if(c=t.find(t=>Math.max(m.clone().valueOf(),t.bookingTimestamp)<Math.min(m.clone().add(o,"minutes").valueOf(),this.dateLib.tz(t.bookingTimestamp,a).add(t.durationInMin,"minutes").valueOf())),c&&h){c=JSON.parse(JSON.stringify(c));let e=t.filter(t=>Math.max(m.clone().valueOf(),t.bookingTimestamp)<Math.min(m.clone().add(o,"minutes").valueOf(),this.dateLib.tz(t.bookingTimestamp,a).add(t.durationInMin,"minutes").valueOf()));c.noOfSameTimeBooking=0;for(let t of e)c.noOfSameTimeBooking=c.noOfSameTimeBooking+t.noOfSameTimeBooking;console.log(`Number of Same time slots: ${c.noOfSameTimeBooking} ${m.format("lll")}`)}let g=!1;if(c&&(g=!0),n.isMaxBookingsEnabled){let e=m.clone().startOf("day").valueOf(),i=m.clone().endOf("day").valueOf(),o=t.filter(t=>n.uniqueId===t.serviceVariantUniqueId).filter(t=>Math.max(e,t.bookingTimestamp)<Math.min(i,this.dateLib.tz(t.bookingTimestamp,a).add(t.durationInMin,"minutes").valueOf())).length;u=o,r=o>=n.maxBookingPerDay}if(this.showModalCart()){let t=this.apntlyBookingModalData.cartItems.filter(t=>t.timeSlot.employee.uniqueId===i.uniqueId),e=t.filter(t=>Math.max(m.clone().valueOf(),t.timeSlot.bookingTimestamp)<Math.min(m.clone().add(o,"minutes").valueOf(),t.timeSlot.bookingTimestamp+60*t.timeSlot.bookingDuration*1e3)),a=(c?c.noOfSameTimeBooking:0)+e.length;if(c?c.noOfSameTimeBooking=a:e.length>0&&(g=!0,c={bookingTimestamp:e[0].timeSlot.bookingTimestamp,durationInMin:e[0].timeSlot.bookingDuration,noOfSameTimeBooking:a,serviceVariantUniqueId:e[0].timeSlot.serviceVariant.uniqueId}),n.isMaxBookingsEnabled){let e=m.clone().startOf("day").valueOf(),i=m.clone().endOf("day").valueOf(),o=t.filter(t=>t.timeSlot.serviceVariant.uniqueId===n.uniqueId).filter(t=>Math.max(e,t.timeSlot.bookingTimestamp)<Math.min(i,t.timeSlot.bookingTimestamp+60*t.timeSlot.bookingDuration*1e3)).length;console.log(t),o+=u,r=r||o>=n.maxBookingPerDay}}if(g&&n.isGroupAppointment&&(console.log("isGroupAppointment",n.isGroupAppointment),c.noOfSameTimeBooking<n.groupAppointmentCapacity&&(h||c.serviceVariantUniqueId===n.uniqueId)&&(g=!1)),g||r&&(g=!0,c={bookingTimestamp:m.clone().valueOf(),durationInMin:o,noOfSameTimeBooking:1,calendarEvent:null}),!g){let t=e.find(t=>Math.max(m.clone().valueOf(),t.startTimeStamp)<Math.min(m.clone().add(o,"minutes").valueOf(),t.endTimeStamp));t&&(g=!0,c={bookingTimestamp:t.startTimeStamp,durationInMin:Math.floor((t.endTimeStamp-t.startTimeStamp)/6e4),noOfSameTimeBooking:1,calendarEvent:t})}if(g){c&&console.log("sameTimeBookedSlot",c);let t="";t=this.showServiceDurationInBookedSlot()?m.clone().add(o,"minutes").format(this.config.slotsTimeFormat):this.dateLib.tz(this.dateLib.tz(c.bookingTimestamp,s).add(c.durationInMin,"minutes").valueOf(),s).format(this.config.slotsTimeFormat),d.push({start:p.format(this.config.slotsTimeFormat),end:t,clientStart:m.format(),clientEnd:m.clone().add(o,"minutes").format(),available:!1,bookingTimestamp:m.valueOf(),bookingDuration:null,serviceVariant:n,employee:i,noOfSameTimeBooking:c?c.noOfSameTimeBooking:0,totalAllowedSlots:n.isGroupAppointment?n.groupAppointmentCapacity:1}),m=this.dateLib.tz(this.dateLib.tz(c.bookingTimestamp,a).add(c.durationInMin,"minutes").valueOf(),a);continue}if(d.push({start:p.format(this.config.slotsTimeFormat),end:p.clone().add(o,"minutes").format(this.config.slotsTimeFormat),clientStart:m.format(),clientEnd:m.clone().add(o,"minutes").format(),available:!0,bookingTimestamp:m.valueOf(),bookingDuration:o,serviceVariant:n,employee:i,noOfSameTimeBooking:c?c.noOfSameTimeBooking:0,totalAllowedSlots:n.isGroupAppointment?n.groupAppointmentCapacity:1}),l)return d}}if(this.isAdmin()&&this.apntlyBookingModalData.showAllSlots)m=m.add(15,"minutes");else if(0===n.startTimeIncrementInMin){let t=this.config.applyBufferTimeOnUnBookedSot?Math.max(n.bufferTimeAfter,n.bufferTimeBefore):0;m=m.add(o+t,"minutes")}else m=m.add(n.startTimeIncrementInMin,"minutes")}}p=p.add(1,"day")}return d})}getCartItemQuestions(){if(this.config.bookingId){let t=this.apntlyBookingModalData.cartItems[0],e=t.timeSlot.serviceVariant;e.uniqueId===this.previousAppointmentData.serviceVariant.uniqueId&&(t.isReScheduleQuestionsProcessed||(this.getValueIfExist(()=>JSON.parse(JSON.stringify(this.previousAppointmentData.properties._data.questions)).length>0)?e.uniqueId===this.previousAppointmentData.serviceVariant.uniqueId&&Object.assign(e.questions,JSON.parse(JSON.stringify(this.previousAppointmentData.properties._data.questions))):Object.assign(e.questions,[])),t.isReScheduleQuestionsProcessed=!0)}let t=[];return this.apntlyBookingModalData.cartItems.map(e=>{let n=e.timeSlot.serviceVariant;n.questions&&n.questions.length>0&&t.push(...n.questions)}),t}onBookNowClicked(){return __awaiter(this,void 0,void 0,function*(){yield this.getProduct(),console.log("bookingId",this.config.bookingId);let t=this.getCartItemQuestions();this.checkingIfCustomQuestionIsFilled||(this.checkingIfCustomQuestionIsFilled=!0,this.window.apntlyBookingModal.calculateCustomQuestionsButtonDisabled(),this.checkingIfCustomQuestionIsFilled=!1);let e=this.isCartItemFreeSubscriptionAppointment();if(t.length>0)t.map(t=>{t.answer=t.answer||""}),this.apntlyBookingModalData.questions=t,this.apntlyBookingModalData.screen=2;else if(this.config.bookingId)this.addToCart();else if(this.service.isFreeService||this.config.isManualBooking||e){if(this.isManualBookingCustomerIdExist())return this.addToCart();this.apntlyBookingModalData.screen=3}else if(this.isDepositEnabled()){if(this.canSkipDepositScreen())return this.depositPaymentButtonClicked();this.apntlyBookingModalData.screen=5}else this.addToCart()})}hideEndTime(){return this.config.hideEndTime}showModalCart(){return!this.config.bookingId&&!this.service.variants.some(t=>t.isSubscriptionAppointment)&&this.config.showModalCart}showTimeSlotMeta(){return!(!this.getSelectedVariant()||!this.getSelectedVariant().isGroupAppointment||!this.timeSlotMetaEnabled&&!["WLVGLAKCAD5E6Z87MF13ITCP","LR7F7B6GQBCSGS5JVBY93CJU"].some(t=>t===this.config.clientUniqueId))}useMobileTopCalendarSelectorLayout(){return!["2MYNK9LEDA2668TM9IE5WUN5"].some(t=>t===this.config.clientUniqueId)}isSubscriptionAppointment(t){let e=this.service.variants.find(e=>e.uniqueId===t);return e&&e.isSubscriptionAppointment}openAccountPage(){window.location.href=`https://${window.location.host}/account/login?checkout_url=${encodeURIComponent(window.location.pathname)}`}getSubscriptionAppointmentMessage(){return __awaiter(this,void 0,void 0,function*(){if(!this.getCustomerId()){if(this.config.addLoginLink?this.apntlyBookingModalData.subscriptionAppointmentMessage='This is a Subscription Booking, account is required to book an appointment. <a href="#" onclick="openAccountPage()" style="color:#105CB6">Please login to Continue</a> ':this.apntlyBookingModalData.subscriptionAppointmentMessage="This is a Subscription Booking, account is required to book an appointment. Please login to Continue","5TV6GCSP966ISLXK9Y1Z3IBK"===this.config.clientUniqueId&&(this.apntlyBookingModalData.subscriptionAppointmentMessage="Esta é uma subscrição, é necessária uma conta. Por favor faça o login para continuar."),"E4EN25IMI8QZDWEV2E32TAXC"===this.config.clientUniqueId&&(this.apntlyBookingModalData.subscriptionAppointmentMessage="This booking requires an account. Create a free account (top right corner of home page) and once you login you can book your spot and pay for this service. Thank you!"),"1CMV3V2A7AFJMMJZ8TQIQJHZ"===this.config.clientUniqueId&&(this.apntlyBookingModalData.subscriptionAppointmentMessage="This service has multiple session, please login to complete your purchase."),"CH4RNS7LZGPH7YRXT82CRGV2"===this.config.clientUniqueId&&(this.apntlyBookingModalData.subscriptionAppointmentMessage="Dieser Kurs hat mehrere Termine, deshalb musst du dich einloggen um mit der Buchung fortzufahren"),"1F9GTGR1DXZA9XI2ZMH8BTGE"===this.config.clientUniqueId&&(this.apntlyBookingModalData.subscriptionAppointmentMessage="Para poder comprar tu paquetes de clases es necesario {{iniciar sesion}}, si no tienes cuenta crea una y vuelve a esta pantalla"),"Q6T2S95T81VB2KJUPG1FVBIH"===this.config.clientUniqueId){let t=`https://${window.location.host}/pages/how-to-activate-your-account`;this.apntlyBookingModalData.subscriptionAppointmentMessage=`Please <a href="#" onclick="openAccountPage()" style="color:#105CB6">login</a> in to your account to request your Date and Time. Trouble logging in? Instructions <a href="${t}" target="_blank" style="color:#105CB6">here</a>.`}if(this.apntlyBookingModalData.subscriptionAppointmentMessage.includes("{{")){let t=this.apntlyBookingModalData.subscriptionAppointmentMessage.split("{{")[1].split("}}")[0];this.apntlyBookingModalData.subscriptionAppointmentMessage=this.apntlyBookingModalData.subscriptionAppointmentMessage.replace("{{"+t+"}}",`<a href="#" onclick="openAccountPage()" style="color:#105CB6">${t}</a>`)}return void this.setBookNowButtonState(!0)}let t=yield this.variantSubscriptionData[this.getSelectedVariant().uniqueId];t.subscriptionSetting,t.isBookingPending||this.setBookNowButtonState(!0),t.subscriptionAppointmentMessage&&(this.apntlyBookingModalData.subscriptionAppointmentMessage=t.subscriptionAppointmentMessage)})}setBookNowButtonState(t){this.apntlyBookingModalData.bookNowDisabled=t,this.apntlyBookingModalData.bookNowButtonKey="bookbk-"+(new Date).valueOf()}isBookNowButtonDisabled(){return 0===this.apntlyBookingModalData.cartItems.length||this.isCartItemSubscriptionAppointment()&&!this.getCustomerId()?this.setBookNowButtonState(!0):this.setBookNowButtonState(!1)}getCustomerId(){return this.isManualBookingCustomerIdExist()?this.getAdminCustomerDetails().shopifyCustomerId:this.config.bookingId&&this.isValidString(this.previousAppointmentData.shopifyCustomerId)?Number(this.previousAppointmentData.shopifyCustomerId):this.window.__st&&this.window.__st.cid||this.getValueIfExist(()=>this.window.ShopifyAnalytics.meta.page.customerId)}getSubscriptionBookingData(t){return __awaiter(this,void 0,void 0,function*(){let e=yield this.getCustomerId();return yield(yield fetch(this.getUrl(`/api/service/${this.service.productId}/subscriptionData`),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscriptionVariantUniqueId:t,clientUniqueId:this.config.clientUniqueId,shopifyCustomerId:e})})).json()})}getCurrentVariantPrice(){if(this.config.productId||this.config.isManualBooking)return"";let t=this.window.appointlyProduct;if(!t||!this.service)return"";let e=this.getSelectedVariant(),n=this.getValueIfExist(()=>t.variants.find(t=>t.id===Number(e.variantId)).price);return n&&(n=this.getValueIfExist(()=>this.window.theme.moneyFormat.replace("{{amount}}",n))),n}customQuestionsButtonClicked(){return __awaiter(this,void 0,void 0,function*(){let t=this.isCartItemFreeSubscriptionAppointment();if(this.config.bookingId)this.addToCart();else if(this.service.isFreeService||this.config.isManualBooking||t){if(this.isManualBookingCustomerIdExist())return this.addToCart();this.apntlyBookingModalData.screen=3}else if(this.isDepositEnabled()){if(this.canSkipDepositScreen())return this.depositPaymentButtonClicked();this.apntlyBookingModalData.screen=5}else this.addToCart()})}customerDetailsQuestionsButtonClicked(){return __awaiter(this,void 0,void 0,function*(){yield this.addToCart()})}depositPaymentButtonClicked(){return __awaiter(this,void 0,void 0,function*(){yield this.addToCart()})}getSelectedSlot(){return this.apntlyBookingModalData&&this.apntlyBookingModalData.cartItems[0]&&this.apntlyBookingModalData.cartItems[0].timeSlot}getSelectedVariant(){return this.service.variants.find(t=>t.uniqueId===this.apntlyBookingModalData.selectedVariant)}processReschedule(t){return __awaiter(this,void 0,void 0,function*(){yield this.window.onReschedule(t)})}processAdminManualBooking(t){return __awaiter(this,void 0,void 0,function*(){yield this.window.onAdminManualBooking(t)})}processFreeBooking(){return __awaiter(this,void 0,void 0,function*(){this.apntlyBookingModalData.screen=3})}addFreeBooking(t){return __awaiter(this,void 0,void 0,function*(){let e=!1;this.config.isAdmin&&this.config.isManualBooking&&this.adminCreateDraftOrder()&&(e=!0);let n={},i=t.map((t,e)=>(t._data.customerDetailQuestions=this.apntlyBookingModalData.customerDetailQuestions,this.isManualBookingCustomerIdExist()&&(t._data.customerDetailQuestions=this.getAdminCustomerDetails()),n=t._data.customerDetailQuestions,{freeBookingLineItemId:"line-item-"+e,properties:t})),o=Object.assign({clientUniqueId:this.config.clientUniqueId,freeBookingUniqueId:this.freeBookingUniqueId,freeBookingLineItems:i},e?{depositPayment:{value:100,type:1}}:{});if(this.isAdmin()&&this.config.isManualBooking)return void this.processAdminManualBooking(o);let a=this.config.apiUrl+"/api/bookings/create/free",s=yield yield fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});200!==s.status&&201!==s.status||(this.apntlyBookingModalData.screen=4),this.freeBookingCompletedEvent({customer:{name:n.name,email:n.email}})})}freeBookingCompletedEvent(t){}adminCreateDraftOrder(){return this.apntlyBookingModalData.adminCreateDraftOrder}addBookingProperty(t){return __awaiter(this,void 0,void 0,function*(){let e=t.map((t,e)=>({uniqueId:t._unique_id,properties:t})),n=this.config.apiUrl+"/api/bookings/create/properties",i=yield yield fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientUniqueId:this.config.clientUniqueId,bookingLineItems:e})});return 200===i.status||(yield this.logToServer(`Error Adding Booking Property Data:${i.status} BookingLineItems:${JSON.stringify(e)}`),!1)})}getBookingHeadingText(){return this.config.bookingInfoSettings.bookingTimeText}getDepositPaymentOptions(){return this.config.depositPaymentSettings.options}clearAllCart(){return __awaiter(this,void 0,void 0,function*(){yield fetch(`https://${window.location.host}/cart/clear.js`,{method:"POST",headers:{"Content-Type":"application/json"}})})}detectAppIntegration(t){return __awaiter(this,void 0,void 0,function*(){let e=[];return this.window.pwyw&&this.integratedAppList.includes("pwyw")&&this.window.pwyw.getVariantId()&&e.push({variant_id:this.window.pwyw.getVariantId(),original_variant_id:t,app:"pwyw"}),e})}addToCart(){return __awaiter(this,void 0,void 0,function*(){if(this.processingAddToCart)return;this.processingAddToCart=!0;let t=[],e=-1;for(let n of this.apntlyBookingModalData.cartItems){e++;let i=n.timeSlot;if(!i.bookingDuration)return void console.log("Invalid booking duration");let o=i.serviceVariant,a=o.variantId;try{if(!o.isGroupAppointment&&this.apntlyBookingModalData.cartItems.findIndex(t=>t.timeSlot.serviceVariant.uniqueId===i.serviceVariant.uniqueId&&t.timeSlot.employee.uniqueId===i.employee.uniqueId&&Number(t.timeSlot.bookingTimestamp)===Number(i.bookingTimestamp))!==e){this.logToServer("DetectedDuplicatedBookingInModalCart");continue}}catch(t){this.logToServer("Error DetectingDuplicatedBookingInModalCart")}let s=o.teamMembers.find(t=>t.uniqueId===i.employee.uniqueId),r=Object.assign(Object.assign({_booking_by:"Appointly",[this.config.bookingInfoSettings.bookingTimeText]:`${this.config.bookingInfoSettings.dateText?this.config.bookingInfoSettings.dateText+":":""} ${this.getDateFromTimestampStartBrowserFormatted(i.bookingTimestamp)} ${this.config.bookingInfoSettings.timeText?this.config.bookingInfoSettings.timeText+":":" "} ${i.start} - ${i.end}`,_booking_start_timestamp:i.bookingTimestamp,_booking_duration:i.bookingDuration,_browser_timezone:this.getBrowserTimezone()},!0===this.config.bookingInfoSettings.hideTeamMember&&this.serviceMergeTeamMemberEnabled()?{}:{[this.config.bookingInfoSettings.teamMemberText]:s.name}),{_employee_unique_id:s.uniqueId,_add_to_cart_at:this.bookingData.dataTimestamp||this.dateLib.tz(this.getCurrentTimeStamp(),this.getBrowserTimezone()).valueOf(),_unique_id:this.getUniqueId()}),l={};l=r,l._data=JSON.parse(JSON.stringify(r)),l._data=JSON.parse(JSON.stringify(r)),l._data.questions=o.questions,l._data.shopifyVariantId=a,l._data.shopifyProductId=this.service.productId,l._data.isAdmin=this.isAdmin(),l._data._customer_timezone=this.getCustomerTimeZone(),this.isAdmin()&&(l._data.sendEmail=this.apntlyBookingModalData.sendEmail),l._data.isSubscriptionAppointment=this.isSubscriptionAppointment(o.uniqueId),l._data.shopifyCustomerId=this.getCustomerId(),l._data._booking_added_to_cart_at=this.getCurrentTimeStamp(),console.log("FreeService",this.service.isFreeService);let d=Number(a),c=yield this.detectAppIntegration(d);c.length&&(c[0].variant_id&&(d=c[0].variant_id),l._data._app_integrations=c),t.push({quantity:1,id:d,properties:l})}if(this.config.bookingId)return void(yield this.processReschedule(t[0].properties));let n=this.isCartItemFreeSubscriptionAppointment();if(this.service.isFreeService||this.config.isManualBooking||n)return void this.addFreeBooking(t.map(t=>t.properties));if(this.isDepositEnabled())return void this.getCheckoutUrl(t.map(t=>t.properties));if(!(yield this.addBookingProperty(t.map(t=>t.properties)))&&(this.log("Error Adding Properties To Server"),this.ignoreAddingPropertiesToCart))return;let i=JSON.parse(JSON.stringify(t));this.ignoreAddingPropertiesToCart&&(i=i.map(t=>{let e={};return["_booking_by","_browser_timezone",this.config.bookingInfoSettings.bookingTimeText,this.config.bookingInfoSettings.teamMemberText,"_unique_id"].map(n=>{e[n]=t.properties[n]}),{quantity:1,id:Number(t.id),properties:e}})),this.skipCartPage&&(yield this.clearAllCart());let o=`https://${window.location.host}/cart/add.js`,a=yield yield fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:i})});if(200===a.status)if(this.skipCartPage)window.location.pathname="/cart/checkout";else{let t=this.getValueIfExist(()=>document.querySelectorAll(this.cartDrawerSelector)[0]);this.openCartDrawer&&t?this.window.apntlyBookingModal.closeModal():window.location.pathname="/cart"}else console.error("Add to cart resp",a)})}isCartItemFreeSubscriptionAppointment(){return this.isCartItemSubscriptionAppointment()&&this.variantSubscriptionData[this.apntlyBookingModalData.cartItems[0].timeSlot.serviceVariant.uniqueId].skipPayment}isCartItemSubscriptionAppointment(){return this.isSubscriptionAppointment(this.apntlyBookingModalData.cartItems[0].timeSlot.serviceVariant.uniqueId)}getDefaultCountry(){return this.defaultCountry||this.getValueIfExist(()=>{fetch("https://www.cloudflare.com/cdn-cgi/trace",{method:"GET"}).then(t=>__awaiter(this,void 0,void 0,function*(){let e=yield t.text();this.defaultCountry=e.split("\n").find(t=>t.includes("loc")).split("=")[1].trim()}))}),this.defaultCountry}isDepositEnabled(){let t=this.config.depositPaymentSettings.isEnabled;return t?(this.service.skipDeposit&&(t=!1),t):t}canSkipDepositScreen(){return!(!this.skipDepositScreen||1!==this.getDepositPaymentOptions().length)}getCheckoutUrl(t){return __awaiter(this,void 0,void 0,function*(){this.canSkipDepositScreen()&&(this.apntlyBookingModalData.selectedDepositPaymentOption=0);let e=t.map((t,e)=>({properties:t,uniqueId:t._unique_id})),n=`${this.config.apiUrl}/api/client/${this.config.clientUniqueId}/deposits/create`,i=yield fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientUniqueId:this.config.clientUniqueId,bookingLineItems:e,depositPayment:{value:Number(this.getDepositPaymentOptions()[this.apntlyBookingModalData.selectedDepositPaymentOption].value),type:Number(this.getDepositPaymentOptions()[this.apntlyBookingModalData.selectedDepositPaymentOption].type)}})});if(200===i.status){let t=yield i.json();window.location.href=t.checkout.url}else console.error("Error getting Checkout Url from Server")})}getAdminCustomerDetails(){return window.manualBookingData&&window.manualBookingData.customer?{shopifyCustomerId:window.manualBookingData.customer.shopifyCustomerId,name:window.manualBookingData.customer.name,email:window.manualBookingData.customer.email,phoneNumberCountryDetails:window.manualBookingData.customer.phoneNumberCountryDetails,phoneNo:window.manualBookingData.customer.phoneNo}:{shopifyCustomerId:null}}isManualBookingCustomerIdExist(){return this.config.isAdmin&&this.config.isManualBooking&&this.getAdminCustomerDetails().shopifyCustomerId}isValidString(t){return t&&(t+=""),t&&""!=t.trim()&&"null"!==t.trim()&&"undefined"!==t.trim()}compareToStringValues(t,e){return this.isValidString(t)&&this.isValidString(e)&&t+""==e+""}getUploadUrl(t,e){return __awaiter(this,void 0,void 0,function*(){return(yield(yield fetch(this.getUrl(`/api/pu/uploadUrl?path=${encodeURIComponent("3/"+this.config.clientUniqueId)}&type=${e}&name=${t}`))).json()).uploadUrl})}uploadFile(t){return __awaiter(this,void 0,void 0,function*(){this.apntlyBookingModalData.isFileUpoading=!0,this.window.apntlyBookingModal.calculateCustomQuestionsButtonDisabled();for(let e of t.target.files){let t=yield this.getUploadUrl(e.name,e.type);if(200===(yield fetch(t,{method:"PUT",body:e,headers:Object.assign({"Content-Type":e.type},t.includes("stlf-pr")?{}:{"x-amz-acl":"public-read"})})).status){let e=t.split("?")[0];console.log(e),this.apntlyBookingModalData.fileUploadQuestion.answer||(this.apntlyBookingModalData.fileUploadQuestion.answer=""),this.apntlyBookingModalData.fileUploadQuestion.answer=this.apntlyBookingModalData.fileUploadQuestion.answer+"\n"+e,this.apntlyBookingModalData.fileUploadQuestion.answer=this.apntlyBookingModalData.fileUploadQuestion.answer.trim(),this.apntlyBookingModalData.fileUploadKey="fillupk-"+(new Date).valueOf()}}this.apntlyBookingModalData.fileUploadKey="fillupk-"+(new Date).valueOf(),this.apntlyBookingModalData.isFileUpoading=!1,
this.window.apntlyBookingModal.calculateCustomQuestionsButtonDisabled()})}getActiveServiceProductIds(){return __awaiter(this,void 0,void 0,function*(){return this.window.activeServiceProductIds&&this.window.activeServiceProductIds.length>0?this.window.activeServiceProductIds:(yield this.isClientActive(),this.window.activeServiceProductIds||[])})}renderButtonOnOtherPages(){return __awaiter(this,void 0,void 0,function*(){let t=yield this.getActiveServiceProductIds();if(!window.location.pathname.includes("/products/"))for(let e of[...document.querySelectorAll(this.fpSelector)]){let n=t.find(t=>e.innerHTML.includes(t));if(!e.innerHTML.includes(n))continue;let i=e.querySelector(this.fpIAESelector),o=document.createElement("button");o.className="btn apntly-page-book-button "+this.fpCN,o.innerText=this.fpBT,o.setAttribute("data-page-product-id",n),i.parentNode.insertBefore(o,i.nextSibling);let a=e.querySelector(this.fpHESelector);a&&(a.style.display="none")}})}hideButtonOnCollectionPage(){return __awaiter(this,void 0,void 0,function*(){let t=yield this.getActiveServiceProductIds();if(window.location.pathname.includes("/collections/"))for(let e of[...document.querySelectorAll(this.cpCSelector)]){let n=t.find(t=>e.innerHTML.includes(t));if(!e.innerHTML.includes(n))continue;if(this.cpIAESelector){let t=e.querySelector(this.cpIAESelector),n=document.createElement("a");n.className="apntly-collection-btn "+this.cpCN,n.innerText="Book Now",n.href="/products/"+e.querySelector(".product-handle").innerText,t.parentNode.insertBefore(n,t.nextSibling)}let i=e.querySelector(this.cpHESelector);i&&(i.style.display="none")}})}getAllLinks(t){return t.split("\n").map(t=>decodeURIComponent(t.split("/").pop()))}removeLink(t,e){let n=t.answer.split("\n");n.splice(e,1),t.answer=n.join("\n"),t.answer=t.answer.trim(),this.apntlyBookingModalData.fileUploadKey="fillupk-"+(new Date).valueOf(),this.window.apntlyBookingModal.calculateCustomQuestionsButtonDisabled()}isEmbedded(){return!!document.querySelector(this.embeddedWidgetContainerSelector)}}exports.AppointlyBookingClient=AppointlyBookingClient;let client=new AppointlyBookingClient;exports.default=client},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AppointlyDepositPaymentType=e.AppointlyDepositLogsEvent=e.AppointlyFloatWidgetAction=e.AppointlySlotTimeFormat=e.AppointlyQuestionType=e.AppointlyLocationType=e.AppointlyWeekDay=e.ServiceAppointmentLevel=void 0,function(t){t[t.Product=1]="Product",t[t.Variant=2]="Variant"}(e.ServiceAppointmentLevel||(e.ServiceAppointmentLevel={})),function(t){t[t.Monday=1]="Monday",t[t.Tuesday=2]="Tuesday",t[t.Wednesday=3]="Wednesday",t[t.Thursday=4]="Thursday",t[t.Friday=5]="Friday",t[t.Saturday=6]="Saturday",t[t.Sunday=7]="Sunday"}(e.AppointlyWeekDay||(e.AppointlyWeekDay={})),function(t){t[t.None=1]="None",t[t.Address=2]="Address",t[t.GoogleMeet=3]="GoogleMeet",t[t.Zoom=4]="Zoom"}(e.AppointlyLocationType||(e.AppointlyLocationType={})),function(t){t[t.Text=1]="Text",t[t.Radio=2]="Radio",t[t.Select=3]="Select",t[t.File=4]="File",t[t.MultiSelect=5]="MultiSelect",t[t.SingleLineText=6]="SingleLineText",t[t.Checkbox=7]="Checkbox"}(e.AppointlyQuestionType||(e.AppointlyQuestionType={})),function(t){t[t.TwelveHour=1]="TwelveHour",t[t.TwentyFourHour=2]="TwentyFourHour"}(e.AppointlySlotTimeFormat||(e.AppointlySlotTimeFormat={})),function(t){t[t.OpenUrl=1]="OpenUrl",t[t.OpenService=2]="OpenService"}(e.AppointlyFloatWidgetAction||(e.AppointlyFloatWidgetAction={})),function(t){t[t.DepositCreated=1]="DepositCreated",t[t.OrderPaid=2]="OrderPaid",t[t.InvoiceSent=3]="InvoiceSent"}(e.AppointlyDepositLogsEvent||(e.AppointlyDepositLogsEvent={})),function(t){t[t.Percentage=1]="Percentage",t[t.Fixed=2]="Fixed"}(e.AppointlyDepositPaymentType||(e.AppointlyDepositPaymentType={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AppointlyProcessData=void 0,e.AppointlyProcessData=class{static isJointGroupAvailability(t){return["H5YUY8MNP5NCDT8LDUS52PRQ","LAC78BMNVEDHZRZSWWWT9NTG","YBTZURJUDSTFW7YUTYG2Z3RE","9EVEUY4GLZHEBUDK5T4F6TAV","C2X4HAH18SAL8PDHXX76CHNM","4WHEY8LXSV8BF46WZNUJ25MR","LR7F7B6GQBCSGS5JVBY93CJU","1GM9XQCPN4U66BWU46TUAF5X","WESHE4L8GEUIGHPSWNYZ9UCC","LU538DLHU7F1WS4VDYB9PZPI","4B3ATXEEC4D5N2FHW4MWSPRZ","V1VAIS58K6S2ULJEFIF2NYRZ","A9R9NUSXF382DXE7QCMFCR9S","1WMXLTZI3J277HN94YCZPVXP"].some(e=>t===e)}static allowDifferentServiceOnSameTime(t){return["UCUFUIDJG5N7DXU6381K71M9"].some(e=>t===e)}static isLargeCalenderEventsExists(t){return["6V3CJP91QGAHB8LRRT2VAAA9","TECYRKEKVSBAMWNZQ9DAUXD8","16QRCMH5RHCG114ALURTBQ4V","R2TIFBVR53HEJEZ5BLHG336L","UWPDUGZ7SFPNJFT8BIT32ZAM","UCUFUIDJG5N7DXU6381K71M9","ZEW2SK5CQDEPW9AMZ1BL7HKC"].some(e=>t===e)}}},function(t,e,n){var i=n(4),o=n(5);t.exports=function(t,e){return o(i,t,e)}},function(t,e){var n=self.crypto||self.msCrypto;t.exports=function(t){return n.getRandomValues(new Uint8Array(t))}},function(t,e){t.exports=function(t,e,n){for(var i=(2<<Math.log(e.length-1)/Math.LN2)-1,o=Math.ceil(1.6*i*n/e.length),a="";;)for(var s=t(o),r=0;r<o;r++){var l=s[r]&i;if(e[l]&&(a+=e[l]).length===n)return a}}}]),window.appointlyClient=AppointlyBookingClient.default,window.appointlyConfig=appointlyConfig,appointlyClient.init(window.appointlyConfig)));